
> filer@0.1.0 test:all
> npm run test:memimg && npm run test:navigator && npm run test:metadata && npm run test:integration && npm run test:browser


> filer@0.1.0 test:memimg
> tsx test/memimg/run-tests.ts

ðŸ§ª MemImg Test Suite

ðŸ“ Found 21 test file(s):

   - test/memimg/unit/types.test.ts
   - test/memimg/unit/type-classifier.test.ts
   - test/memimg/unit/transaction-proxy.test.ts
   - test/memimg/unit/serialize.test.ts
   - test/memimg/unit/replay.test.ts
   - test/memimg/unit/proxy.test.ts
   - test/memimg/unit/proxy-unwrapper.test.ts
   - test/memimg/unit/event-log.test.ts
   - test/memimg/unit/event-handlers.test.ts
   - test/memimg/unit/deserialize.test.ts
   - test/memimg/unit/delta-manager.test.ts
   - test/memimg/unit/constants.test.ts
   - test/memimg/unit/collection-wrapper.test.ts
   - test/memimg/integration/transaction.test.ts
   - test/memimg/integration/persistence.test.ts
   - test/memimg/integration/memimg-core.test.ts
   - test/memimg/integration/event-sourcing.test.ts
   - test/memimg/integration/edge-cases.test.ts
   - test/memimg/integration/date-object-properties.test.ts
   - test/memimg/integration/collections.test.ts
   - test/memimg/integration/circular-references.test.ts

â–¶ types
  â–¶ Path conversion functions
    â–¶ toMutablePath
      âœ” converts immutable Path to mutable array (0.460625ms)
      âœ” returns new array instance (0.066084ms)
      âœ” handles empty path (0.048333ms)
      âœ” handles single-segment path (0.046958ms)
      âœ” creates independent copy (0.050375ms)
    âœ” toMutablePath (1.036375ms)
    â–¶ toPath
      âœ” converts mutable array to immutable Path (0.06725ms)
      âœ” returns same reference (no copy) (0.041583ms)
      âœ” handles empty array (0.186ms)
      âœ” handles single-segment array (0.090125ms)
    âœ” toPath (0.672417ms)
    â–¶ roundtrip conversion
      âœ” Path -> MutablePath -> Path preserves content (0.074458ms)
      âœ” handles deep paths (0.378834ms)
    âœ” roundtrip conversion (0.494125ms)
  âœ” Path conversion functions (2.489167ms)
  â–¶ isSerializedReference
    âœ” returns true for valid reference objects (0.08225ms)
    âœ” returns false for objects without __type__ (0.032833ms)
    âœ” returns false for objects with wrong __type__ (0.02975ms)
    âœ” returns false for null (0.027584ms)
    âœ” returns false for undefined (0.027292ms)
    âœ” returns false for primitives (0.029625ms)
    âœ” returns false for arrays (0.026834ms)
    âœ” returns true for ref with empty path (0.02975ms)
    âœ” returns false for objects missing path property (0.031083ms)
  âœ” isSerializedReference (0.397625ms)
  â–¶ isUnresolvedReference
    âœ” returns true for unresolved reference markers (0.061167ms)
    âœ” returns false for objects without __isUnresolved (0.032625ms)
    âœ” returns false for objects with __isUnresolved false (0.028583ms)
    âœ” returns false for null (0.02825ms)
    âœ” returns false for undefined (0.029292ms)
    âœ” returns false for primitives (0.030125ms)
    âœ” returns true even without path property (0.031542ms)
  âœ” isUnresolvedReference (0.308792ms)
  â–¶ isObject
    âœ” returns true for plain objects (0.082125ms)
    âœ” returns true for arrays (0.0305ms)
    âœ” returns true for Date objects (0.031667ms)
    âœ” returns true for Map and Set (0.045708ms)
    âœ” returns false for functions (0.034375ms)
    âœ” returns false for null (0.027334ms)
    âœ” returns false for undefined (0.028ms)
    âœ” returns false for primitives (0.032292ms)
    âœ” returns false for BigInt (0.035958ms)
    âœ” returns false for Symbol (0.033709ms)
    âœ” returns true for Object.create(null) (0.029ms)
    âœ” returns true for custom class instances (0.05375ms)
  âœ” isObject (0.575583ms)
âœ” types (3.9885ms)
â–¶ type-classifier
  â–¶ classifyValue
    â–¶ NULL category
      âœ” classifies null correctly (0.343958ms)
    âœ” NULL category (0.67275ms)
    â–¶ UNDEFINED category
      âœ” classifies undefined correctly (0.130167ms)
    âœ” UNDEFINED category (0.175167ms)
    â–¶ PRIMITIVE category
      âœ” classifies string correctly (0.09475ms)
      âœ” classifies number correctly (0.084792ms)
      âœ” classifies boolean correctly (0.043708ms)
      âœ” classifies negative numbers (0.088375ms)
      âœ” classifies zero (0.225375ms)
      âœ” classifies NaN (0.058666ms)
      âœ” classifies Infinity (0.08525ms)
      âœ” classifies empty string (0.156959ms)
    âœ” PRIMITIVE category (1.629125ms)
    â–¶ BIGINT category
      âœ” classifies BigInt correctly (0.068708ms)
      âœ” classifies negative BigInt (0.034833ms)
      âœ” classifies zero BigInt (0.044208ms)
    âœ” BIGINT category (0.237416ms)
    â–¶ SYMBOL category
      âœ” classifies Symbol correctly (0.056375ms)
      âœ” classifies Symbol without description (0.0315ms)
      âœ” classifies well-known Symbols (0.032ms)
    âœ” SYMBOL category (0.159125ms)
    â–¶ DATE category
      âœ” classifies Date correctly (0.055ms)
      âœ” classifies invalid Date (0.038083ms)
      âœ” classifies epoch Date (0.033042ms)
    âœ” DATE category (0.170958ms)
    â–¶ FUNCTION category
      âœ” classifies function correctly (0.06175ms)
      âœ” classifies named function (0.047375ms)
      âœ” classifies arrow function (0.037084ms)
      âœ” classifies async function (0.087667ms)
      âœ” classifies generator function (0.034208ms)
    âœ” FUNCTION category (0.326542ms)
    â–¶ ARRAY category
      âœ” classifies Array correctly (0.063875ms)
      âœ” classifies empty Array (0.047916ms)
      âœ” classifies nested Array (0.04ms)
      âœ” classifies sparse Array (0.037541ms)
    âœ” ARRAY category (0.2375ms)
    â–¶ MAP category
      âœ” classifies Map correctly (0.057667ms)
      âœ” classifies empty Map (0.032ms)
      âœ” classifies Map with object keys (0.041125ms)
    âœ” MAP category (0.170458ms)
    â–¶ SET category
      âœ” classifies Set correctly (0.056625ms)
      âœ” classifies empty Set (0.033959ms)
      âœ” classifies Set with objects (0.057125ms)
    âœ” SET category (0.195125ms)
    â–¶ OBJECT category
      âœ” classifies plain object correctly (0.062625ms)
      âœ” classifies empty object (0.032625ms)
      âœ” classifies nested object (0.035292ms)
      âœ” classifies Object.create(null) (0.036084ms)
    âœ” OBJECT category (0.211584ms)
  âœ” classifyValue (4.65125ms)
  â–¶ Type guard helpers
    â–¶ isNullish
      âœ” returns true for null (0.050917ms)
      âœ” returns true for undefined (0.0305ms)
      âœ” returns false for other values (0.033583ms)
    âœ” isNullish (0.155833ms)
    â–¶ isPrimitive
      âœ” returns true for primitives (0.058375ms)
      âœ” returns false for objects (0.036041ms)
    âœ” isPrimitive (0.125708ms)
    â–¶ isPlainObject
      âœ” returns true for plain objects (0.061791ms)
      âœ” returns false for non-plain objects (0.038542ms)
    âœ” isPlainObject (1.3315ms)
    â–¶ isCollection
      âœ” returns true for collections (0.221333ms)
      âœ” returns false for non-collections (0.122583ms)
    âœ” isCollection (0.471042ms)
    â–¶ isObject
      âœ” returns true for objects (0.173792ms)
      âœ” returns false for non-objects (0.105209ms)
    âœ” isObject (0.379791ms)
  âœ” Type guard helpers (2.725458ms)
âœ” type-classifier (7.608125ms)
â–¶ transaction-proxy
  â–¶ createTransactionProxy
    âœ” creates proxy for memory image (0.431917ms)
    âœ” caches proxy for same object (0.063625ms)
    âœ” registers proxy in target cache (0.053ms)
  âœ” createTransactionProxy (0.8775ms)
  â–¶ GET trap
    âœ” reads from base memimg (0.086667ms)
    âœ” reads from delta when property modified (1.151292ms)
    âœ” returns undefined for deleted properties (0.208334ms)
    âœ” wraps nested objects in proxies (0.146875ms)
    âœ” does not double-wrap proxies (0.249416ms)
    âœ” passes through symbols unchanged (0.122042ms)
  âœ” GET trap (2.349209ms)
  â–¶ SET trap
    âœ” stores changes in delta (0.123333ms)
    âœ” does not modify base memimg (0.048667ms)
    âœ” tracks nested property changes (0.051417ms)
    âœ” handles multiple changes to same property (0.203166ms)
    âœ” handles adding new properties (0.0575ms)
  âœ” SET trap (0.556458ms)
  â–¶ DELETE trap
    âœ” marks property as deleted in delta (0.079875ms)
    âœ” does not modify base memimg (0.03975ms)
    âœ” handles deleting nested properties (0.058834ms)
  âœ” DELETE trap (0.237416ms)
  â–¶ HAS trap
    âœ” checks base memimg for property (0.087084ms)
    âœ” returns true for added properties in delta (0.039916ms)
    âœ” returns false for deleted properties (0.040292ms)
    âœ” checks nested object properties (0.041916ms)
    âœ” returns true for delta property marked as non-deleted (0.052709ms)
  âœ” HAS trap (0.322625ms)
  â–¶ ownKeys trap
    âœ” returns base keys (0.280292ms)
    âœ” includes added keys from delta (0.075709ms)
    âœ” excludes deleted keys (0.05225ms)
    âœ” handles nested object keys (0.051166ms)
    âœ” combines base and delta keys without duplicates (0.135ms)
    âœ” handles complex delta operations on keys (0.135041ms)
  âœ” ownKeys trap (0.801833ms)
  â–¶ getOwnPropertyDescriptor trap
    âœ” returns descriptor for base properties (0.077708ms)
    âœ” returns descriptor for delta properties (0.043292ms)
    âœ” returns undefined for deleted properties (0.067375ms)
    âœ” returns descriptor for nested properties (0.043167ms)
    âœ” returns descriptor for modified delta properties (0.04125ms)
    âœ” returns undefined for non-existent properties (0.0385ms)
  âœ” getOwnPropertyDescriptor trap (0.375209ms)
  â–¶ Array method interception
    âœ” intercepts array push (0.118583ms)
    âœ” intercepts array pop (0.047542ms)
    âœ” intercepts array shift (0.042708ms)
    âœ” intercepts array unshift (0.067875ms)
    âœ” intercepts array splice (0.042916ms)
    âœ” intercepts array sort (0.154ms)
    âœ” intercepts array reverse (0.044584ms)
    âœ” binds non-mutating array methods correctly (0.052833ms)
  âœ” Array method interception (0.656291ms)
  â–¶ Complex scenarios
    âœ” handles deep nested changes (0.073125ms)
    âœ” handles mixed operations (0.069167ms)
    âœ” maintains delta count correctly (0.045833ms)
  âœ” Complex scenarios (0.230541ms)
  â–¶ Edge cases
    âœ” handles empty object (1.868ms)
    âœ” handles null prototype objects (0.260916ms)
    âœ” handles reading undefined properties (0.144958ms)
    âœ” handles multiple proxy levels (0.156ms)
  âœ” Edge cases (2.630292ms)
âœ” transaction-proxy (9.666584ms)
â–¶ serialize
  â–¶ serializeMemoryImage - primitives
    âœ” serializes null (0.50225ms)
    âœ” serializes undefined (0.056583ms)
    âœ” serializes string (0.048208ms)
    âœ” serializes number (0.051417ms)
    âœ” serializes boolean (0.039959ms)
    âœ” serializes zero (0.042ms)
    âœ” serializes negative numbers (0.1035ms)
    âœ” serializes empty string (0.041333ms)
  âœ” serializeMemoryImage - primitives (2.207625ms)
  â–¶ serializeMemoryImage - special types
    âœ” serializes BigInt (0.146917ms)
    âœ” serializes Symbol (0.184541ms)
    âœ” serializes Symbol without description (0.0555ms)
    âœ” serializes Date (0.871042ms)
    âœ” serializes Date with properties (0.087542ms)
    âœ” serializes function with __type__ (0.102542ms)
    âœ” returns undefined for non-serializable function (0.043333ms)
  âœ” serializeMemoryImage - special types (1.617625ms)
  â–¶ serializeMemoryImage - simple objects
    âœ” serializes empty object (0.134208ms)
    âœ” serializes flat object (0.185583ms)
    âœ” serializes nested object (0.068708ms)
    âœ” serializes deeply nested object (0.128625ms)
    âœ” serializes object with mixed types (0.066333ms)
  âœ” serializeMemoryImage - simple objects (0.649333ms)
  â–¶ serializeMemoryImage - arrays
    âœ” serializes empty array (0.068291ms)
    âœ” serializes flat array (0.051959ms)
    âœ” serializes nested array (0.047375ms)
    âœ” serializes array with mixed types (0.238458ms)
    âœ” serializes array with objects (0.11725ms)
  âœ” serializeMemoryImage - arrays (0.640875ms)
  â–¶ serializeMemoryImage - collections
    âœ” serializes empty Map (0.1455ms)
    âœ” serializes Map with entries (0.095042ms)
    âœ” serializes Map with object keys (0.054792ms)
    âœ” serializes empty Set (0.0455ms)
    âœ” serializes Set with values (0.054916ms)
    âœ” serializes Set with objects (0.048625ms)
  âœ” serializeMemoryImage - collections (0.554666ms)
  â–¶ serializeMemoryImage - circular references
    âœ” detects simple circular reference (0.07425ms)
    âœ” detects circular reference through parent (0.053958ms)
    âœ” detects circular reference in array (0.045417ms)
    âœ” handles shared references (not circular) (0.046833ms)
  âœ” serializeMemoryImage - circular references (0.301625ms)
  â–¶ serializeMemoryImage - proxy unwrapping
    âœ” unwraps proxy to target (0.059416ms)
    âœ” handles nested proxies (0.047791ms)
  âœ” serializeMemoryImage - proxy unwrapping (0.156958ms)
  â–¶ serializeValueForEvent - primitives
    âœ” serializes primitive value (0.070333ms)
    âœ” serializes string value (0.034542ms)
    âœ” serializes null (0.03975ms)
  âœ” serializeValueForEvent - primitives (0.187792ms)
  â–¶ serializeValueForEvent - objects
    âœ” serializes new object (0.084625ms)
    âœ” serializes nested object (1.023167ms)
  âœ” serializeValueForEvent - objects (1.154291ms)
  â–¶ serializeValueForEvent - reference detection
    âœ” creates reference for object outside value tree (0.122292ms)
    âœ” does not create reference for object within value tree (0.053292ms)
    âœ” detects internal circular reference (0.045042ms)
  âœ” serializeValueForEvent - reference detection (0.2845ms)
  â–¶ serializeValueForEvent - collections
    âœ” serializes new Map (0.07025ms)
    âœ” serializes new Set (0.048792ms)
    âœ” serializes new Array (0.049ms)
  âœ” serializeValueForEvent - collections (0.214459ms)
  â–¶ serializeValueForEvent - special types
    âœ” serializes Date (0.075667ms)
    âœ” serializes BigInt (0.041291ms)
    âœ” serializes Symbol (0.049458ms)
  âœ” serializeValueForEvent - special types (0.209417ms)
  â–¶ Edge cases
    âœ” handles empty path (0.087792ms)
    âœ” handles object with null prototype (0.044334ms)
    âœ” handles sparse arrays (0.042667ms)
    âœ” handles NaN (0.043875ms)
    âœ” handles Infinity (0.033958ms)
    âœ” handles very deep nesting (0.095542ms)
    âœ” handles large array (0.212667ms)
    âœ” handles mixed collection types (0.070542ms)
  âœ” Edge cases (0.701959ms)
âœ” serialize (9.738041ms)
â–¶ replay
  â–¶ replayEvents - array input
    âœ” replays SET event (0.626ms)
    âœ” replays multiple SET events (0.091459ms)
    âœ” replays DELETE event (0.069083ms)
    âœ” replays nested SET events (0.130583ms)
    âœ” replays ARRAY_PUSH event (0.87125ms)
    âœ” replays MAP_SET event (0.078ms)
    âœ” handles empty event array (0.099667ms)
  âœ” replayEvents - array input (2.500833ms)
  â–¶ replayEvents - async iterable input
    âœ” replays events from async iterable (0.154833ms)
    âœ” handles empty async iterable (0.107208ms)
  âœ” replayEvents - async iterable input (0.532625ms)
  â–¶ replayFromEventLog
    âœ” replays events from event log with getAll (0.163792ms)
    âœ” replays events from event log with stream (0.089958ms)
    âœ” handles empty event log (0.04775ms)
  âœ” replayFromEventLog (0.349084ms)
  â–¶ replay state management
    âœ” sets isReplaying to true during replay (0.068916ms)
    âœ” restores isReplaying after replay (0.035375ms)
  âœ” replay state management (0.185792ms)
  â–¶ event ordering
    âœ” replays events in order (0.063708ms)
    âœ” handles interleaved paths correctly (0.050084ms)
  âœ” event ordering (0.149333ms)
âœ” replay (4.197834ms)
â–¶ proxy
  â–¶ createProxyInfrastructure
    âœ” creates infrastructure with WeakMaps (0.372083ms)
    âœ” accepts optional metadata provider (0.09425ms)
    âœ” creates infrastructure without metadata (0.048334ms)
  âœ” createProxyInfrastructure (0.867167ms)
  â–¶ wrapIfNeeded - primitives
    âœ” returns null unchanged (0.139959ms)
    âœ” returns undefined unchanged (0.211375ms)
    âœ” returns string unchanged (0.12075ms)
    âœ” returns number unchanged (0.053416ms)
    âœ” returns boolean unchanged (0.224792ms)
    âœ” returns BigInt unchanged (0.108584ms)
    âœ” returns Symbol unchanged (0.187083ms)
  âœ” wrapIfNeeded - primitives (1.671ms)
  â–¶ Date proxying
    âœ” should proxy Date objects (0.187584ms)
    âœ” should preserve Date methods through proxy (3.051917ms)
    âœ” should allow Date property mutations through proxy (0.328084ms)
    âœ” should handle Date type coercion through proxy (0.123667ms)
    âœ” should handle Date with nested object properties (0.190875ms)
  âœ” Date proxying (4.131917ms)
  â–¶ wrapIfNeeded - functions
    âœ” wraps function with metadata (0.1285ms)
    âœ” wrapped function remains callable (0.055ms)
    âœ” wrapped function has source code (0.053959ms)
  âœ” wrapIfNeeded - functions (0.36775ms)
  â–¶ wrapIfNeeded - objects
    âœ” wraps plain object in proxy (0.084292ms)
    âœ” registers object in targetToProxy (0.041583ms)
    âœ” registers proxy in proxyToTarget (0.037875ms)
    âœ” registers path in targetToPath (0.107ms)
    âœ” returns same proxy for same object (0.039833ms)
    âœ” returns proxy if value is already a proxy (0.040625ms)
  âœ” wrapIfNeeded - objects (0.422666ms)
  â–¶ wrapIfNeeded - arrays
    âœ” wraps array in proxy (0.071583ms)
    âœ” recursively wraps array elements (0.051584ms)
    âœ” preserves array length (0.039125ms)
  âœ” wrapIfNeeded - arrays (0.209125ms)
  â–¶ wrapIfNeeded - Map
    âœ” wraps Map in proxy (0.266584ms)
    âœ” recursively wraps Map values (0.175166ms)
    âœ” recursively wraps Map keys if they are objects (0.124625ms)
    âœ” preserves Map size (0.12275ms)
  âœ” wrapIfNeeded - Map (0.9ms)
  â–¶ wrapIfNeeded - Set
    âœ” wraps Set in proxy (0.22175ms)
    âœ” recursively wraps Set values if they are objects (0.069ms)
    âœ” preserves Set size (0.046917ms)
  âœ” wrapIfNeeded - Set (0.418208ms)
  â–¶ wrapIfNeeded - nested structures
    âœ” recursively wraps nested objects (0.071375ms)
    âœ” assigns correct paths to nested objects (0.051916ms)
    âœ” wraps nested arrays (0.050458ms)
  âœ” wrapIfNeeded - nested structures (0.233875ms)
  â–¶ wrapIfNeeded - circular references
    âœ” handles simple circular reference (0.059291ms)
    âœ” handles circular reference through child (0.042333ms)
    âœ” reuses same proxy for circular reference (0.034875ms)
  âœ” wrapIfNeeded - circular references (0.184125ms)
  â–¶ Proxy GET trap
    âœ” intercepts property access (0.066834ms)
    âœ” returns wrapped values for object properties (0.034125ms)
    âœ” wraps Array mutation methods (0.092792ms)
    âœ” wraps Map mutation methods (0.045792ms)
    âœ” wraps Set mutation methods (0.039083ms)
  âœ” Proxy GET trap (0.331083ms)
  â–¶ Proxy SET trap
    âœ” intercepts property assignment (0.058709ms)
    âœ” wraps assigned object values (0.035958ms)
    âœ” logs SET event when event log provided (0.223583ms)
    âœ” does not log during replay (0.040916ms)
    âœ” assigns correct path to new objects (0.04075ms)
  âœ” Proxy SET trap (0.451709ms)
  â–¶ Proxy DELETE trap
    âœ” intercepts property deletion (0.072625ms)
    âœ” logs DELETE event when event log provided (0.05475ms)
    âœ” does not log during replay (0.036291ms)
  âœ” Proxy DELETE trap (0.2ms)
  â–¶ Collection method wrapping
    âœ” wrapped Array.push logs event (0.111125ms)
    âœ” wrapped Map.set logs event (0.063334ms)
    âœ” wrapped Set.add logs event (0.055125ms)
  âœ” Collection method wrapping (0.2685ms)
  â–¶ Complex scenarios
    âœ” handles deeply nested mutations (0.070459ms)
    âœ” handles mixed mutations (0.064334ms)
    âœ” preserves object identity through mutations (0.036083ms)
  âœ” Complex scenarios (0.206625ms)
  â–¶ Edge cases
    âœ” handles empty objects (0.053125ms)
    âœ” handles empty arrays (0.040458ms)
    âœ” handles null prototype objects (0.0395ms)
    âœ” handles objects with symbols (0.037041ms)
  âœ” Edge cases (0.219583ms)
âœ” proxy (12.807625ms)
â–¶ proxy-unwrapper
  â–¶ deepUnwrap - primitives
    âœ” returns primitives unchanged (0.461042ms)
    âœ” returns BigInt unchanged (0.055708ms)
    âœ” returns Symbol unchanged (0.045459ms)
  âœ” deepUnwrap - primitives (0.889292ms)
  â–¶ deepUnwrap - proxy unwrapping
    âœ” unwraps proxy to target (0.078042ms)
    âœ” returns object as-is if not a proxy (0.071ms)
    âœ” handles nested proxies (0.116083ms)
  âœ” deepUnwrap - proxy unwrapping (0.408042ms)
  â–¶ deepUnwrap - arrays
    âœ” unwraps array elements (0.179958ms)
    âœ” recursively unwraps nested arrays (0.168917ms)
    âœ” unwraps proxied array elements (0.107834ms)
  âœ” deepUnwrap - arrays (0.66025ms)
  â–¶ deepUnwrap - objects
    âœ” unwraps object properties (0.126792ms)
    âœ” recursively unwraps nested objects (0.484708ms)
    âœ” unwraps proxied property values (0.057958ms)
  âœ” deepUnwrap - objects (0.783333ms)
  â–¶ deepUnwrap - circular references
    âœ” handles circular object references with seen map (0.064333ms)
    âœ” handles circular array references (0.046458ms)
    âœ” handles complex circular graphs (0.0425ms)
  âœ” deepUnwrap - circular references (0.1985ms)
  â–¶ deepUnwrap - mixed structures
    âœ” handles objects containing arrays (0.1155ms)
    âœ” handles arrays containing objects (0.0455ms)
    âœ” handles deeply nested mixed structures (0.041542ms)
  âœ” deepUnwrap - mixed structures (0.241667ms)
  â–¶ deepUnwrap - edge cases
    âœ” handles empty objects (0.0535ms)
    âœ” handles empty arrays (0.0325ms)
    âœ” handles objects with null prototype (0.036458ms)
    âœ” preserves object identity when seen (0.041375ms)
  âœ” deepUnwrap - edge cases (0.210167ms)
âœ” proxy-unwrapper (3.879541ms)
â–¶ event-log
  â–¶ createInMemoryEventLog
    âœ” creates event log (0.457791ms)
    âœ” starts with zero length (0.814584ms)
    âœ” appends event (0.123667ms)
    âœ” appends multiple events (0.07875ms)
    âœ” getAll returns empty array initially (0.129125ms)
    âœ” getAll returns all events (0.065958ms)
    âœ” getAll returns copy (not original array) (0.134375ms)
    âœ” clear removes all events (0.076542ms)
    âœ” maintains event order (0.179375ms)
    âœ” handles events with complex values (0.308666ms)
    âœ” handles DELETE events (0.094958ms)
    âœ” handles large number of events (3.113708ms)
  âœ” createInMemoryEventLog (6.2825ms)
  â–¶ createFileEventLog
    âœ” creates event log (12.288042ms)
    âœ” creates file if it does not exist (1.385583ms)
    âœ” appends event to file (0.934292ms)
    âœ” appends multiple events (1.103167ms)
    âœ” getAll returns empty array for empty file (0.819834ms)
    âœ” getAll returns all events (1.003375ms)
    âœ” maintains NDJSON format (1.647083ms)
    âœ” stream returns async iterable (2.841959ms)
    âœ” stream works for large files (6.625042ms)
    âœ” clear empties file (2.522083ms)
    âœ” persists events across log instances (2.401125ms)
EventLog close(): Database was never initialized (events) Error: IndexedDB not available (browser only)
    at <anonymous> (/Users/ricardo/Workspace/filer/src/memimg/event-log.ts:237:14)
    at new Promise (<anonymous>)
    at createIndexedDBEventLog (/Users/ricardo/Workspace/filer/src/memimg/event-log.ts:235:23)
    at TestContext.<anonymous> (/Users/ricardo/Workspace/filer/test/memimg/unit/event-log.test.ts:386:19)
    at Test.runInAsyncScope (node:async_hooks:214:14)
    at Test.run (node:internal/test_runner/test:1047:25)
    at Suite.processPendingSubtests (node:internal/test_runner/test:744:18)
    at Test.postRun (node:internal/test_runner/test:1173:19)
    at Test.run (node:internal/test_runner/test:1101:12)
    at async Promise.all (index 0)
    âœ” handles events with complex values (1.539791ms)
  âœ” createFileEventLog (35.761875ms)
  â–¶ createIndexedDBEventLog
    âœ” throws error in Node.js environment (0.766042ms)
    âœ” has close method (4.055542ms)
  âœ” createIndexedDBEventLog (4.956916ms)
  â–¶ createLocalStorageEventLog
    âœ” throws error in Node.js environment (0.139708ms)
  âœ” createLocalStorageEventLog (0.180417ms)
  â–¶ EventLog interface compliance
    âœ” InMemoryEventLog implements EventLog interface (0.056333ms)
    âœ” all event logs return promises (0.080375ms)
  âœ” EventLog interface compliance (0.172625ms)
  â–¶ Event preservation
    âœ” preserves event type (0.082416ms)
    âœ” preserves event path (0.046916ms)
    âœ” preserves event value (0.048667ms)
    âœ” preserves event timestamp (0.042125ms)
  âœ” Event preservation (0.656875ms)
  â–¶ Edge cases
    âœ” handles empty path (0.15975ms)
    âœ” handles null value (0.038ms)
    âœ” handles undefined value (0.047ms)
    âœ” handles events without value property (0.043ms)
    âœ” handles very long paths (0.073666ms)
  âœ” Edge cases (0.414583ms)
  â–¶ Performance
    âœ” handles rapid appends (0.203166ms)
    âœ” getAll is efficient for large logs (3.96125ms)
  âœ” Performance (4.219417ms)
âœ” event-log (53.122292ms)
â–¶ event-handlers
  â–¶ SetEventHandler
    âœ” creates SET event with primitive value (0.697667ms)
    âœ” creates SET event with object value (0.128875ms)
    âœ” applies SET event (0.162459ms)
    âœ” applies SET event with nested value (0.072208ms)
  âœ” SetEventHandler (1.479875ms)
  â–¶ DeleteEventHandler
    âœ” creates DELETE event (0.092459ms)
    âœ” applies DELETE event (0.10825ms)
    âœ” applies DELETE event to nested property (0.052417ms)
  âœ” DeleteEventHandler (0.511333ms)
  â–¶ ArrayPushHandler
    âœ” creates ARRAY_PUSH event (0.105833ms)
    âœ” applies ARRAY_PUSH event (0.186458ms)
    âœ” applies ARRAY_PUSH event with objects (0.19775ms)
  âœ” ArrayPushHandler (0.624459ms)
  â–¶ ArrayPopHandler
    âœ” creates ARRAY_POP event (0.08175ms)
    âœ” applies ARRAY_POP event (0.114833ms)
    âœ” applies ARRAY_POP event to empty array (0.04275ms)
  âœ” ArrayPopHandler (0.290041ms)
  â–¶ ArrayShiftHandler
    âœ” creates ARRAY_SHIFT event (0.06825ms)
    âœ” applies ARRAY_SHIFT event (0.0505ms)
  âœ” ArrayShiftHandler (0.161125ms)
  â–¶ ArrayUnshiftHandler
    âœ” creates ARRAY_UNSHIFT event (0.08625ms)
    âœ” applies ARRAY_UNSHIFT event (0.054166ms)
  âœ” ArrayUnshiftHandler (0.177ms)
  â–¶ ArraySpliceHandler
    âœ” creates ARRAY_SPLICE event (0.093792ms)
    âœ” applies ARRAY_SPLICE event - replace elements (0.055167ms)
    âœ” applies ARRAY_SPLICE event - insert only (0.040416ms)
    âœ” applies ARRAY_SPLICE event - delete only (0.039167ms)
  âœ” ArraySpliceHandler (0.278541ms)
  â–¶ ArraySortHandler
    âœ” creates ARRAY_SORT event (0.481833ms)
    âœ” applies ARRAY_SORT event (0.1895ms)
  âœ” ArraySortHandler (0.775125ms)
  â–¶ ArrayReverseHandler
    âœ” creates ARRAY_REVERSE event (1.049208ms)
    âœ” applies ARRAY_REVERSE event (0.17975ms)
  âœ” ArrayReverseHandler (1.328875ms)
  â–¶ ArrayFillHandler
    âœ” creates ARRAY_FILL event (0.11975ms)
    âœ” applies ARRAY_FILL event (0.061333ms)
    âœ” applies ARRAY_FILL event - full array (0.044167ms)
  âœ” ArrayFillHandler (0.283417ms)
  â–¶ ArrayCopyWithinHandler
    âœ” creates ARRAY_COPYWITHIN event (0.070583ms)
    âœ” applies ARRAY_COPYWITHIN event (0.048875ms)
  âœ” ArrayCopyWithinHandler (0.15075ms)
  â–¶ MapSetHandler
    âœ” creates MAP_SET event (0.086875ms)
    âœ” applies MAP_SET event (0.054083ms)
    âœ” applies MAP_SET event with object key (0.049666ms)
  âœ” MapSetHandler (0.227333ms)
  â–¶ MapDeleteHandler
    âœ” creates MAP_DELETE event (0.063667ms)
    âœ” applies MAP_DELETE event (0.049375ms)
  âœ” MapDeleteHandler (0.143209ms)
  â–¶ MapClearHandler
    âœ” creates MAP_CLEAR event (0.056208ms)
    âœ” applies MAP_CLEAR event (0.044042ms)
  âœ” MapClearHandler (0.130833ms)
  â–¶ SetAddHandler
    âœ” creates SET_ADD event (0.05675ms)
    âœ” applies SET_ADD event (0.052959ms)
  âœ” SetAddHandler (0.13825ms)
  â–¶ SetDeleteHandler
    âœ” creates SET_DELETE event (0.057875ms)
    âœ” applies SET_DELETE event (0.056584ms)
  âœ” SetDeleteHandler (0.142291ms)
  â–¶ SetClearHandler
    âœ” creates SET_CLEAR event (0.052541ms)
    âœ” applies SET_CLEAR event (0.042541ms)
  âœ” SetClearHandler (0.123084ms)
  â–¶ ScriptEventHandler
    âœ” creates SCRIPT event (0.061417ms)
    âœ” applies SCRIPT event (no-op) (0.039209ms)
  âœ” ScriptEventHandler (0.129333ms)
  â–¶ EventHandlerRegistry
    âœ” registers handler (0.0695ms)
    âœ” throws for unknown event type on createEvent (0.080625ms)
    âœ” throws for unknown event type on applyEvent (0.047625ms)
    âœ” checks if handler exists (0.034541ms)
    âœ” has all 18 event handlers registered (0.055417ms)
  âœ” EventHandlerRegistry (0.338375ms)
  â–¶ Event creation edge cases
    âœ” handles empty path (0.056708ms)
    âœ” handles deeply nested path (0.038708ms)
    âœ” handles multiple arguments in array push (0.043ms)
  âœ” Event creation edge cases (0.175583ms)
  â–¶ Event application edge cases
    âœ” applies event to nested target (0.058584ms)
    âœ” applies multiple events in sequence (0.208458ms)
  âœ” Event application edge cases (0.355ms)
âœ” event-handlers (9.36425ms)
ï¹£ deserialize (0.663958ms) # SKIP
â–¶ delta-manager
  â–¶ initialization
    âœ” creates empty delta manager (0.350375ms)
    âœ” provides DELETED symbol (0.058916ms)
    âœ” DELETED symbol is consistent (0.046375ms)
  âœ” initialization (0.793084ms)
  â–¶ isDirty / size
    âœ” isDirty returns false when empty (0.07775ms)
    âœ” isDirty returns true after set (0.047375ms)
    âœ” size returns 0 when empty (0.091792ms)
    âœ” size increases with each set (0.04725ms)
    âœ” size remains same for duplicate sets (0.229625ms)
  âœ” isDirty / size (0.731583ms)
  â–¶ has / get / set
    âœ” has returns false for missing paths (1.212417ms)
    âœ” has returns true after set (0.561542ms)
    âœ” get returns undefined for missing paths (0.16875ms)
    âœ” get returns value after set (0.110667ms)
    âœ” set stores values correctly (0.128958ms)
    âœ” set overwrites existing values (0.101208ms)
    âœ” handles object values (0.104ms)
    âœ” handles array values (0.25525ms)
  âœ” has / get / set (2.966125ms)
  â–¶ delete / isDeleted
    âœ” delete marks path with DELETED symbol (0.201583ms)
    âœ” isDeleted returns true for deleted paths (0.091833ms)
    âœ” isDeleted returns false for regular values (0.092458ms)
    âœ” isDeleted returns false for missing paths (0.090917ms)
    âœ” delete increments size (0.102541ms)
    âœ” can set after delete (0.106583ms)
  âœ” delete / isDeleted (1.026083ms)
  â–¶ clear
    âœ” clears all entries (0.164167ms)
    âœ” clear removes all paths (0.190042ms)
    âœ” can set after clear (0.187ms)
  âœ” clear (0.702792ms)
  â–¶ entries
    âœ” returns empty array when empty (0.395958ms)
    âœ” returns all entries (0.196375ms)
    âœ” sorts entries by depth (shallowest first) (0.147042ms)
    âœ” includes deleted entries (0.118667ms)
    âœ” sorts complex paths correctly (0.145791ms)
    âœ” entries are [path, value] tuples (0.119125ms)
  âœ” entries (1.37575ms)
  â–¶ createCheckpoint
    âœ” creates snapshot of current delta (0.497ms)
    âœ” checkpoint is independent copy (0.163334ms)
    âœ” checkpoint preserves values (0.107959ms)
    âœ” checkpoint preserves deletions (0.106542ms)
    âœ” empty checkpoint (0.0985ms)
  âœ” createCheckpoint (1.198ms)
  â–¶ restoreCheckpoint
    âœ” restores delta to checkpoint state (0.24725ms)
    âœ” clears changes after checkpoint (0.110292ms)
    âœ” restores empty state (0.140833ms)
    âœ” handles multiple restore cycles (0.12225ms)
    âœ” restores deletions (0.123833ms)
  âœ” restoreCheckpoint (0.951ms)
  â–¶ edge cases
    âœ” handles paths with special characters (0.19625ms)
    âœ” handles very long paths (0.115875ms)
    âœ” handles numeric path segments (0.109417ms)
    âœ” handles single-segment paths (0.099875ms)
    âœ” handles many entries efficiently (10.1025ms)
  âœ” edge cases (10.856625ms)
âœ” delta-manager (21.515666ms)
â–¶ constants
  â–¶ EVENT_TYPES
    âœ” has all 18 event types defined (0.411375ms)
    âœ” includes all property event types (0.056167ms)
    âœ” includes all array event types (0.053708ms)
    âœ” includes all Map event types (0.045875ms)
    âœ” includes all Set event types (0.038458ms)
    âœ” includes SCRIPT event type (0.040334ms)
    âœ” has no duplicate values (0.090708ms)
    âœ” all values are uppercase strings (0.110208ms)
  âœ” EVENT_TYPES (1.380833ms)
  â–¶ TYPE_MARKERS
    âœ” has TYPE marker (0.116ms)
    âœ” has UNRESOLVED marker (0.154875ms)
    âœ” has UNRESOLVED_REF marker (0.042875ms)
    âœ” has no duplicate values (0.039708ms)
  âœ” TYPE_MARKERS (0.438583ms)
  â–¶ PATH_SEPARATOR
    âœ” is a dot character (0.083666ms)
  âœ” PATH_SEPARATOR (1.042792ms)
  â–¶ NUMERIC_KEY_PATTERN
    âœ” matches numeric strings (0.13775ms)
    âœ” does not match non-numeric strings (0.038292ms)
  âœ” NUMERIC_KEY_PATTERN (0.2685ms)
  â–¶ MUTATING_ARRAY_METHODS
    âœ” includes all 9 mutating methods (0.048292ms)
    âœ” includes expected methods (0.05625ms)
    âœ” has no duplicates (0.037ms)
  âœ” MUTATING_ARRAY_METHODS (0.185667ms)
  â–¶ MUTATING_MAP_METHODS
    âœ” includes all 3 mutating methods (0.041583ms)
    âœ” includes expected methods (0.032ms)
  âœ” MUTATING_MAP_METHODS (0.104708ms)
  â–¶ MUTATING_SET_METHODS
    âœ” includes all 3 mutating methods (0.042833ms)
    âœ” includes expected methods (0.03475ms)
  âœ” MUTATING_SET_METHODS (0.108667ms)
  â–¶ Storage constants
    âœ” has DEFAULT_DB_NAME (0.052125ms)
    âœ” has DEFAULT_STORE_NAME (0.03275ms)
    âœ” has DEFAULT_LOCALSTORAGE_KEY (0.029709ms)
  âœ” Storage constants (0.154333ms)
âœ” constants (4.259375ms)
â–¶ collection-wrapper
  â–¶ Array methods
    âœ” wraps push method (0.975583ms)
    âœ” wraps pop method (0.108375ms)
    âœ” wraps shift method (0.080459ms)
    âœ” wraps unshift method (0.095083ms)
    âœ” wraps splice method (0.08825ms)
    âœ” wraps sort method (0.076583ms)
    âœ” wraps reverse method (0.113334ms)
    âœ” wraps fill method (0.173417ms)
    âœ” wraps copyWithin method (0.175708ms)
  âœ” Array methods (4.315375ms)
  â–¶ Map methods
    âœ” wraps set method (0.133416ms)
    âœ” wraps delete method (0.136125ms)
    âœ” wraps clear method (0.069458ms)
  âœ” Map methods (0.409166ms)
  â–¶ Set methods
    âœ” wraps add method (0.0825ms)
    âœ” wraps delete method (0.058375ms)
    âœ” wraps clear method (0.125375ms)
  âœ” Set methods (0.330625ms)
  â–¶ Event logging
    âœ” does not log when no event log provided (0.065625ms)
    âœ” does not log when replaying (0.042416ms)
    âœ” logs with correct path from infrastructure (0.057416ms)
    âœ” uses empty path when not in infrastructure (0.045ms)
  âœ” Event logging (0.322375ms)
  â–¶ Error handling
    âœ” throws for unknown collection type (0.090666ms)
  âœ” Error handling (0.120459ms)
  â–¶ Method execution
    âœ” executes original method with correct context (0.066125ms)
    âœ” returns original method result (0.049833ms)
    âœ” handles methods with no arguments (0.046375ms)
  âœ” Method execution (0.203083ms)
  â–¶ Integration with event registry
    âœ” creates properly formatted events (0.094875ms)
  âœ” Integration with event registry (0.127459ms)
âœ” collection-wrapper (6.244042ms)
â–¶ transaction integration
  â–¶ Transaction creation
    âœ” creates transaction with empty root (0.545333ms)
    âœ” initializes as not dirty (0.105791ms)
    âœ” has zero uncommitted count initially (0.068625ms)
  âœ” Transaction creation (1.056291ms)
  â–¶ isDirty tracking
    âœ” becomes dirty after mutation (0.1025ms)
    âœ” becomes clean after save (0.377375ms)
    âœ” becomes clean after discard (0.134084ms)
  âœ” isDirty tracking (0.767292ms)
  â–¶ save() - persisting changes
    âœ” applies changes to base and logs events (0.164958ms)
    âœ” persists multiple changes (0.127834ms)
    âœ” persists nested changes (0.245334ms)
    âœ” allows mutations after save (0.2375ms)
  âœ” save() - persisting changes (0.937958ms)
  â–¶ discard() - rolling back changes
    âœ” discards uncommitted changes (0.147209ms)
    âœ” preserves committed changes (0.142833ms)
    âœ” discards multiple changes (0.055167ms)
    âœ” does not log discarded changes (0.051541ms)
  âœ” discard() - rolling back changes (0.456291ms)
  â–¶ getUncommittedCount()
    âœ” returns zero initially (0.067209ms)
    âœ” increments with changes (0.0465ms)
    âœ” resets to zero after save (0.069292ms)
    âœ” resets to zero after discard (0.048ms)
  âœ” getUncommittedCount() (0.279459ms)
  â–¶ Checkpoints
    âœ” creates checkpoint of current state (0.079667ms)
    âœ” restores to checkpoint (0.0725ms)
    âœ” handles multiple checkpoints (0.121333ms)
    âœ” checkpoint before empty transaction (0.052833ms)
  âœ” Checkpoints (0.378458ms)
  â–¶ Complex scenarios
    âœ” save-modify-discard cycle (4.007709ms)
    âœ” checkpoint-modify-restore-save cycle (0.279459ms)
    âœ” nested object modifications (0.135084ms)
    âœ” array mutations in transaction (0.239792ms)
  âœ” Complex scenarios (4.785667ms)
âœ” transaction integration (9.171542ms)
â–¶ persistence integration
  â–¶ Full save/load cycle
    âœ” persists simple object (1.784583ms)
    âœ” persists nested objects (1.826416ms)
    âœ” persists arrays (0.562375ms)
    âœ” persists collections (0.321875ms)
  âœ” Full save/load cycle (4.916167ms)
  â–¶ Event log persistence
    âœ” reconstructs state from event log (0.407625ms)
    âœ” handles multiple mutation cycles (0.144208ms)
    âœ” handles complex event sequence (0.389167ms)
  âœ” Event log persistence (1.698375ms)
  â–¶ Snapshot + events
    âœ” combines snapshot with incremental events (10.74325ms)
    âœ” handles large initial state with mutations (0.639792ms)
  âœ” Snapshot + events (11.643583ms)
  â–¶ Incremental persistence
    âœ” supports append-only event log (0.370542ms)
    âœ” replays from specific point in event log (0.298417ms)
  âœ” Incremental persistence (0.998792ms)
  â–¶ Error recovery
    âœ” handles corrupted snapshot gracefully (0.377291ms)
    âœ” continues from valid events after error (0.205875ms)
  âœ” Error recovery (0.703209ms)
  â–¶ Large dataset persistence
    âœ” handles large object graphs (2.514792ms)
    âœ” handles many events (0.402917ms)
  âœ” Large dataset persistence (3.0025ms)
  â–¶ Special types persistence
    âœ” persists Date objects (2.172375ms)
    âœ” persists BigInt values (0.330875ms)
    âœ” persists mixed special types (0.298458ms)
  âœ” Special types persistence (2.946291ms)
  â–¶ Real-world scenarios
    âœ” simulates user session persistence (0.398333ms)
    âœ” simulates game state persistence (0.345458ms)
  âœ” Real-world scenarios (0.863333ms)
âœ” persistence integration (28.259209ms)
â–¶ memimg-core integration
  â–¶ createMemoryImage
    âœ” creates memory image from empty object (1.528167ms)
    âœ” creates memory image from populated object (0.169209ms)
    âœ” tracks mutations automatically with event log (0.651375ms)
    âœ” creates proxies for nested objects (0.239584ms)
    âœ” handles arrays in initial data (1.346709ms)
    âœ” handles Maps in initial data (0.114042ms)
    âœ” handles Sets in initial data (0.136834ms)
    âœ” accepts metadata provider (0.081792ms)
  âœ” createMemoryImage (5.097834ms)
  â–¶ Mutation tracking
    âœ” logs property assignments (0.171417ms)
    âœ” logs property deletions (0.225917ms)
    âœ” logs nested mutations (0.111167ms)
    âœ” logs array mutations (0.122041ms)
  âœ” Mutation tracking (0.728167ms)
  â–¶ Serialization
    âœ” serializes simple memory image (0.148416ms)
    âœ” serializes nested objects (0.056291ms)
    âœ” serializes arrays (0.201875ms)
    âœ” serializes Maps (0.085667ms)
    âœ” serializes Sets (0.064708ms)
    âœ” handles circular references (0.048125ms)
    âœ” serializes Scott employee data (0.959334ms)
  âœ” Serialization (2.9875ms)
  â–¶ Deserialization
    âœ” deserializes simple JSON (0.523125ms)
    âœ” deserializes nested objects (0.136125ms)
    âœ” deserializes arrays (0.22725ms)
    âœ” deserializes Maps (0.107958ms)
    âœ” deserializes Sets (0.0685ms)
    âœ” deserializes Dates (0.095083ms)
  âœ” Deserialization (1.324125ms)
  â–¶ Serialization roundtrip
    âœ” preserves simple data (0.084542ms)
    âœ” preserves nested structures (0.1505ms)
    âœ” preserves arrays (0.086708ms)
    âœ” preserves all JavaScript types (0.257166ms)
  âœ” Serialization roundtrip (0.632958ms)
  â–¶ isMemoryImage
    âœ” returns true for memory image (0.060125ms)
    âœ” returns false for plain object (0.029958ms)
    âœ” returns false for null (0.029042ms)
    âœ” returns false for primitives (0.035584ms)
  âœ” isMemoryImage (0.202667ms)
  â–¶ getMemoryImageMetadata
    âœ” returns custom metadata provider (0.071125ms)
    âœ” returns default metadata for memory image without custom provider (0.033833ms)
  âœ” getMemoryImageMetadata (0.150459ms)
  â–¶ getMemoryImageInfrastructure
    âœ” returns infrastructure for memory image (0.053333ms)
    âœ” returns null for non-memory image (0.030459ms)
  âœ” getMemoryImageInfrastructure (0.115833ms)
âœ” memimg-core integration (11.874709ms)
â–¶ event-sourcing integration
  â–¶ basic mutation-event-replay cycle
    âœ” logs SET event and replays correctly (1.041625ms)
    âœ” logs DELETE event and replays correctly (0.175042ms)
    âœ” logs nested property SET and replays (0.239917ms)
  âœ” basic mutation-event-replay cycle (1.864459ms)
  â–¶ array mutations
    âœ” ARRAY_PUSH event cycle (0.352541ms)
    âœ” ARRAY_POP event cycle (0.135083ms)
    âœ” ARRAY_SHIFT event cycle (0.246917ms)
    âœ” ARRAY_UNSHIFT event cycle (0.2015ms)
    âœ” ARRAY_SPLICE event cycle (0.527333ms)
    âœ” ARRAY_SORT event cycle (0.186334ms)
    âœ” ARRAY_REVERSE event cycle (0.287125ms)
    âœ” ARRAY_FILL event cycle (0.149792ms)
    âœ” ARRAY_COPYWITHIN event cycle (0.104708ms)
  âœ” array mutations (2.48925ms)
  â–¶ Map mutations
    âœ” MAP_SET event cycle (0.172875ms)
    âœ” MAP_DELETE event cycle (0.119041ms)
    âœ” MAP_CLEAR event cycle (0.087291ms)
  âœ” Map mutations (0.430875ms)
  â–¶ Set mutations
    âœ” SET_ADD event cycle (0.13325ms)
    âœ” SET_DELETE event cycle (0.10175ms)
    âœ” SET_CLEAR event cycle (0.660125ms)
  âœ” Set mutations (1.017375ms)
  â–¶ complex scenarios
    âœ” multiple mutations replay in correct order (0.094666ms)
    âœ” nested object mutations (0.097334ms)
    âœ” mixed collection operations (0.111625ms)
    âœ” employee-department data (3.592667ms)
    âœ” property deletion and recreation (0.116042ms)
    âœ” array element modification (0.087ms)
  âœ” complex scenarios (4.191792ms)
  â–¶ special types
    âœ” Date values survive replay (0.118709ms)
    âœ” BigInt values survive replay (0.085375ms)
    âœ” Function values survive replay (0.163042ms)
  âœ” special types (0.414583ms)
  â–¶ event ordering and timestamps
    âœ” events have monotonically increasing timestamps (0.067833ms)
    âœ” replay applies events in timestamp order (0.06175ms)
  âœ” event ordering and timestamps (0.164875ms)
âœ” event-sourcing integration (10.980542ms)
â–¶ edge-cases integration
  â–¶ Empty and minimal values
    âœ” handles empty object (0.783666ms)
    âœ” handles empty arrays (0.151792ms)
    âœ” handles empty collections (0.201459ms)
    âœ” handles empty strings (0.161583ms)
    âœ” handles zero values (0.198292ms)
  âœ” Empty and minimal values (1.980917ms)
  â–¶ Null and undefined
    âœ” handles null values (0.2315ms)
    âœ” handles undefined values (0.090667ms)
    âœ” distinguishes null from undefined (0.312208ms)
    âœ” handles setting property to null (0.149375ms)
  âœ” Null and undefined (1.194917ms)
  â–¶ Special numeric values
    âœ” handles NaN (0.139167ms)
    âœ” handles Infinity (0.0695ms)
    âœ” handles very large numbers (0.0815ms)
    âœ” handles very small numbers (0.051959ms)
  âœ” Special numeric values (0.409166ms)
  â–¶ Deep nesting
    âœ” handles deeply nested objects (2.64575ms)
    âœ” handles deeply nested arrays (0.254875ms)
    âœ” handles deeply nested mutations (0.135667ms)
  âœ” Deep nesting (3.094708ms)
  â–¶ Large data volumes
    âœ” handles many properties (5.386458ms)
    âœ” handles large arrays (1.469292ms)
    âœ” handles many events (1.99725ms)
    âœ” handles large Maps (0.833625ms)
    âœ” handles large Sets (0.342625ms)
  âœ” Large data volumes (10.148792ms)
  â–¶ Unusual keys and properties
    âœ” handles numeric string keys (0.085791ms)
    âœ” handles keys with special characters (0.047167ms)
    âœ” handles symbol properties (0.045042ms)
    âœ” handles very long property names (0.1305ms)
  âœ” Unusual keys and properties (0.367167ms)
  â–¶ Rapid mutations
    âœ” handles rapid property changes (0.198167ms)
    âœ” handles rapid array mutations (0.263459ms)
    âœ” handles rapid collection mutations (0.3755ms)
  âœ” Rapid mutations (0.885375ms)
  â–¶ Unusual mutation patterns
    âœ” handles delete then set same property (0.119208ms)
    âœ” handles set then delete then set (0.053792ms)
    âœ” handles replacing object with primitive (0.10275ms)
    âœ” handles replacing primitive with object (0.092209ms)
    âœ” handles replacing array with map (0.069083ms)
  âœ” Unusual mutation patterns (0.496667ms)
  â–¶ Null prototype objects
    âœ” handles objects with null prototype (0.077042ms)
    âœ” handles mutations on null prototype objects (0.064584ms)
  âœ” Null prototype objects (0.176791ms)
  â–¶ Concurrent-like operations
    âœ” handles interleaved mutations (0.120666ms)
    âœ” handles mutations on different paths (0.134291ms)
  âœ” Concurrent-like operations (0.392333ms)
  â–¶ Type changes
    âœ” handles changing value types (0.101333ms)
    âœ” handles bigint to number conversions (0.048333ms)
  âœ” Type changes (0.188417ms)
  â–¶ Memory and performance
    âœ” handles repeated serialization (0.202792ms)
    âœ” handles repeated deserialization (0.155042ms)
    âœ” handles many replay cycles (0.381208ms)
  âœ” Memory and performance (0.783333ms)
  â–¶ Boundary conditions
    âœ” handles maximum array length edge case (0.079625ms)
    âœ” handles Date at epoch (1.133083ms)
    âœ” handles empty Map and Set operations (0.146833ms)
  âœ” Boundary conditions (1.4155ms)
âœ” edge-cases integration (22.444125ms)
â–¶ Date Objects with Properties - Critical Bug Tests
  âœ” FAILS: should preserve simple properties on Date objects (1.729583ms)
  âœ” FAILS: should preserve array properties on Date (0.436291ms)
  âœ” FAILS: should preserve nested object properties on Date (0.228917ms)
  âœ” FAILS: should track Date property mutations through proxy (0.293667ms)
  âœ” FAILS: should handle circular references involving Date objects (0.176458ms)
  âœ” FAILS: should preserve Date methods after serialization (0.080292ms)
  âœ” FAILS: should handle Date with Map property (0.138959ms)
  âœ” FAILS: should handle Date with Set property (0.361417ms)
  âœ” FAILS: should handle invalid Date with properties (0.584792ms)
  âœ” FAILS: should handle Date properties in complex object graph (0.62025ms)
âœ” Date Objects with Properties - Critical Bug Tests (5.506ms)
â–¶ collections integration
  â–¶ Array operations
    âœ” tracks array push operations (1.044333ms)
    âœ” tracks array pop operations (0.119208ms)
    âœ” tracks array shift operations (0.081667ms)
    âœ” tracks array unshift operations (0.253417ms)
    âœ” tracks array splice operations (0.110458ms)
    âœ” replays array operations correctly (0.513958ms)
    âœ” handles array with object elements (0.42125ms)
    âœ” serializes and deserializes arrays (0.449375ms)
    âœ” handles nested arrays (0.271666ms)
    âœ” handles array sort (0.342375ms)
    âœ” handles array reverse (0.082542ms)
  âœ” Array operations (4.382584ms)
  â–¶ Map operations
    âœ” tracks Map set operations (0.142875ms)
    âœ” tracks Map delete operations (0.072208ms)
    âœ” tracks Map clear operations (0.073167ms)
    âœ” replays Map operations correctly (0.219834ms)
    âœ” handles Map with object values (0.0685ms)
    âœ” handles Map with object keys (0.060834ms)
    âœ” serializes and deserializes Maps (0.810625ms)
    âœ” handles nested Maps (0.085875ms)
  âœ” Map operations (1.64725ms)
  â–¶ Set operations
    âœ” tracks Set add operations (0.133542ms)
    âœ” tracks Set delete operations (0.063292ms)
    âœ” tracks Set clear operations (0.05575ms)
    âœ” replays Set operations correctly (0.131333ms)
    âœ” handles Set with object values (0.052333ms)
    âœ” serializes and deserializes Sets (0.476792ms)
    âœ” handles nested Sets (0.089333ms)
    âœ” Set does not add duplicates (0.070375ms)
  âœ” Set operations (1.181125ms)
  â–¶ Mixed collection operations
    âœ” handles arrays, maps, and sets together (0.103084ms)
    âœ” handles collections containing other collections (0.069708ms)
    âœ” serializes mixed collections (0.118041ms)
    âœ” replays mixed collection operations (0.217125ms)
  âœ” Mixed collection operations (0.56525ms)
  â–¶ Collection edge cases
    âœ” handles empty collections (0.077292ms)
    âœ” handles large arrays (0.173333ms)
    âœ” handles sparse arrays (0.056416ms)
    âœ” handles Map with mixed key types (0.053583ms)
  âœ” Collection edge cases (0.413166ms)
âœ” collections integration (8.561375ms)
â–¶ circular-references integration
  â–¶ Simple circular references
    âœ” handles self-reference (0.515125ms)
    âœ” serializes self-reference (0.21125ms)
    âœ” deserializes self-reference (0.176125ms)
    âœ” roundtrip preserves self-reference (0.074375ms)
  âœ” Simple circular references (1.315333ms)
  â–¶ Parent-child circular references
    âœ” handles parent-child cycle (0.180166ms)
    âœ” serializes parent-child cycle (0.274042ms)
    âœ” deserializes parent-child cycle (0.145042ms)
  âœ” Parent-child circular references (0.833208ms)
  â–¶ Array circular references
    âœ” handles array containing itself (0.156791ms)
    âœ” serializes circular array (0.17775ms)
    âœ” handles array elements referencing parent (0.188083ms)
    âœ” roundtrip preserves array circular reference (0.089708ms)
  âœ” Array circular references (0.823833ms)
  â–¶ Complex circular graphs
    âœ” handles bidirectional references (0.079375ms)
    âœ” handles triangle of references (0.060042ms)
    âœ” serializes complex graph (0.062292ms)
    âœ” deserializes complex graph (0.139625ms)
  âœ” Complex circular graphs (0.398291ms)
  â–¶ Event sourcing with circular references
    âœ” logs events with circular references (0.221083ms)
    âœ” replays events with circular references (0.767458ms)
    âœ” handles mutations on circular structures (0.069ms)
  âœ” Event sourcing with circular references (1.11325ms)
  â–¶ Shared references (not circular)
    âœ” handles shared object references (0.058208ms)
    âœ” serializes shared references (0.048667ms)
    âœ” deserializes shared references correctly (0.052833ms)
  âœ” Shared references (not circular) (0.2015ms)
  â–¶ Mixed circular and acyclic structures
    âœ” handles mix of circular and non-circular refs (0.072791ms)
    âœ” serializes mixed structures (0.045083ms)
    âœ” deserializes mixed structures (0.053834ms)
  âœ” Mixed circular and acyclic structures (0.208667ms)
  â–¶ Deep circular references
    âœ” handles deeply nested circular reference (0.052208ms)
    âœ” roundtrip preserves deep circular reference (0.053916ms)
  âœ” Deep circular references (0.134875ms)
  â–¶ Collections with circular references
    âœ” handles Map with circular value (0.06275ms)
    âœ” handles Set with circular value (0.041125ms)
    âœ” serializes Map with circular values (0.064625ms)
  âœ” Collections with circular references (0.260083ms)
  â–¶ Edge cases
    âœ” handles long circular chain (0.084333ms)
    âœ” handles empty circular object (0.045542ms)
    âœ” handles multiple paths to same circular object (0.037416ms)
  âœ” Edge cases (0.210542ms)
âœ” circular-references integration (6.095125ms)

============================================================
ðŸ“Š Test Summary
============================================================
âœ… Passed:  929
âŒ Failed:  0
â­ï¸  Skipped: 0
ðŸ“ˆ Total:   929
============================================================

âœ… All tests passed!


> filer@0.1.0 test:navigator
> npm run test:navigator:unit


> filer@0.1.0 test:navigator:unit
> node --test test/navigator/unit/**/*.test.ts

TAP version 13
# Subtest: Collection Adapters
    # Subtest: ArrayAdapter
        # Subtest: getChildren
            # Subtest: returns empty array for empty array
            ok 1 - returns empty array for empty array
              ---
              duration_ms: 0.40175
              type: 'test'
              ...
            # Subtest: returns indexed children for simple array
            ok 2 - returns indexed children for simple array
              ---
              duration_ms: 0.077167
              type: 'test'
              ...
            # Subtest: returns children for nested array
            ok 3 - returns children for nested array
              ---
              duration_ms: 0.437875
              type: 'test'
              ...
            # Subtest: returns children for object array
            ok 4 - returns children for object array
              ---
              duration_ms: 0.070666
              type: 'test'
              ...
            # Subtest: handles sparse arrays
            ok 5 - handles sparse arrays
              ---
              duration_ms: 0.058125
              type: 'test'
              ...
            # Subtest: handles arrays with mixed types
            ok 6 - handles arrays with mixed types
              ---
              duration_ms: 0.157916
              type: 'test'
              ...
            1..6
        ok 1 - getChildren
          ---
          duration_ms: 1.681167
          type: 'suite'
          ...
        # Subtest: createChildPath
            # Subtest: creates numeric string path for array index
            ok 1 - creates numeric string path for array index
              ---
              duration_ms: 0.247167
              type: 'test'
              ...
            # Subtest: creates paths for multiple indices
            ok 2 - creates paths for multiple indices
              ---
              duration_ms: 0.211208
              type: 'test'
              ...
            # Subtest: preserves parent path
            ok 3 - preserves parent path
              ---
              duration_ms: 0.216375
              type: 'test'
              ...
            1..3
        ok 2 - createChildPath
          ---
          duration_ms: 0.984458
          type: 'suite'
          ...
        1..2
    ok 1 - ArrayAdapter
      ---
      duration_ms: 2.857292
      type: 'suite'
      ...
    # Subtest: MapAdapter
        # Subtest: getChildren
            # Subtest: returns empty array for empty map
            ok 1 - returns empty array for empty map
              ---
              duration_ms: 0.248041
              type: 'test'
              ...
            # Subtest: returns key-value children for simple map
            ok 2 - returns key-value children for simple map
              ---
              duration_ms: 0.237208
              type: 'test'
              ...
            # Subtest: returns children for nested map
            ok 3 - returns children for nested map
              ---
              duration_ms: 0.181541
              type: 'test'
              ...
            # Subtest: handles numeric keys
            ok 4 - handles numeric keys
              ---
              duration_ms: 0.148625
              type: 'test'
              ...
            # Subtest: handles object keys
            ok 5 - handles object keys
              ---
              duration_ms: 0.17175
              type: 'test'
              ...
            # Subtest: preserves insertion order
            ok 6 - preserves insertion order
              ---
              duration_ms: 0.132458
              type: 'test'
              ...
            1..6
        ok 1 - getChildren
          ---
          duration_ms: 1.345416
          type: 'suite'
          ...
        # Subtest: createChildPath
            # Subtest: creates map:N path for map entry
            ok 1 - creates map:N path for map entry
              ---
              duration_ms: 0.213042
              type: 'test'
              ...
            # Subtest: creates paths for multiple indices
            ok 2 - creates paths for multiple indices
              ---
              duration_ms: 0.136208
              type: 'test'
              ...
            1..2
        ok 2 - createChildPath
          ---
          duration_ms: 0.46775
          type: 'suite'
          ...
        1..2
    ok 2 - MapAdapter
      ---
      duration_ms: 1.952625
      type: 'suite'
      ...
    # Subtest: SetAdapter
        # Subtest: getChildren
            # Subtest: returns empty array for empty set
            ok 1 - returns empty array for empty set
              ---
              duration_ms: 0.269
              type: 'test'
              ...
            # Subtest: returns indexed children for simple set
            ok 2 - returns indexed children for simple set
              ---
              duration_ms: 0.160833
              type: 'test'
              ...
            # Subtest: returns children for object set
            ok 3 - returns children for object set
              ---
              duration_ms: 1.340458
              type: 'test'
              ...
            # Subtest: preserves insertion order
            ok 4 - preserves insertion order
              ---
              duration_ms: 0.055417
              type: 'test'
              ...
            # Subtest: handles mixed type set
            ok 5 - handles mixed type set
              ---
              duration_ms: 0.045833
              type: 'test'
              ...
            1..5
        ok 1 - getChildren
          ---
          duration_ms: 2.021542
          type: 'suite'
          ...
        # Subtest: createChildPath
            # Subtest: creates set:N path for set entry
            ok 1 - creates set:N path for set entry
              ---
              duration_ms: 0.065
              type: 'test'
              ...
            # Subtest: creates paths for multiple indices
            ok 2 - creates paths for multiple indices
              ---
              duration_ms: 0.041792
              type: 'test'
              ...
            1..2
        ok 2 - createChildPath
          ---
          duration_ms: 0.146792
          type: 'suite'
          ...
        1..2
    ok 3 - SetAdapter
      ---
      duration_ms: 2.290959
      type: 'suite'
      ...
    # Subtest: getCollectionAdapter
        # Subtest: returns ArrayAdapter for array
        ok 1 - returns ArrayAdapter for array
          ---
          duration_ms: 0.078667
          type: 'test'
          ...
        # Subtest: returns MapAdapter for Map
        ok 2 - returns MapAdapter for Map
          ---
          duration_ms: 0.041875
          type: 'test'
          ...
        # Subtest: returns SetAdapter for Set
        ok 3 - returns SetAdapter for Set
          ---
          duration_ms: 0.036292
          type: 'test'
          ...
        # Subtest: returns null for non-collection
        ok 4 - returns null for non-collection
          ---
          duration_ms: 0.204792
          type: 'test'
          ...
        # Subtest: returns null for Date (not a collection)
        ok 5 - returns null for Date (not a collection)
          ---
          duration_ms: 0.051084
          type: 'test'
          ...
        # Subtest: returns null for Function (not a collection)
        ok 6 - returns null for Function (not a collection)
          ---
          duration_ms: 0.038083
          type: 'test'
          ...
        1..6
    ok 4 - getCollectionAdapter
      ---
      duration_ms: 0.537167
      type: 'suite'
      ...
    # Subtest: isCollection
        # Subtest: returns true for array
        ok 1 - returns true for array
          ---
          duration_ms: 0.083625
          type: 'test'
          ...
        # Subtest: returns true for Map
        ok 2 - returns true for Map
          ---
          duration_ms: 0.035958
          type: 'test'
          ...
        # Subtest: returns true for Set
        ok 3 - returns true for Set
          ---
          duration_ms: 0.0335
          type: 'test'
          ...
        # Subtest: returns false for plain object
        ok 4 - returns false for plain object
          ---
          duration_ms: 0.033667
          type: 'test'
          ...
        # Subtest: returns false for primitives
        ok 5 - returns false for primitives
          ---
          duration_ms: 0.0355
          type: 'test'
          ...
        # Subtest: returns false for Date
        ok 6 - returns false for Date
          ---
          duration_ms: 0.057083
          type: 'test'
          ...
        # Subtest: returns false for Function
        ok 7 - returns false for Function
          ---
          duration_ms: 0.030625
          type: 'test'
          ...
        1..7
    ok 5 - isCollection
      ---
      duration_ms: 0.381459
      type: 'suite'
      ...
    # Subtest: edge cases
        # Subtest: handles very large arrays
        ok 1 - handles very large arrays
          ---
          duration_ms: 5.36725
          type: 'test'
          ...
        # Subtest: handles very large maps
        ok 2 - handles very large maps
          ---
          duration_ms: 6.172459
          type: 'test'
          ...
        # Subtest: handles very large sets
        ok 3 - handles very large sets
          ---
          duration_ms: 8.962959
          type: 'test'
          ...
        # Subtest: handles arrays with undefined values
        ok 4 - handles arrays with undefined values
          ---
          duration_ms: 0.185291
          type: 'test'
          ...
        # Subtest: handles maps with undefined values
        ok 5 - handles maps with undefined values
          ---
          duration_ms: 0.06925
          type: 'test'
          ...
        # Subtest: handles sets with objects (identity)
        ok 6 - handles sets with objects (identity)
          ---
          duration_ms: 0.053625
          type: 'test'
          ...
        1..6
    ok 6 - edge cases
      ---
      duration_ms: 20.960458
      type: 'suite'
      ...
    1..6
ok 1 - Collection Adapters
  ---
  duration_ms: 29.642791
  type: 'suite'
  ...
# Subtest: formatters
    # Subtest: NullFormatter
        # Subtest: formats null as empty string in preview mode
        ok 1 - formats null as empty string in preview mode
          ---
          duration_ms: 0.427291
          type: 'test'
          ...
        # Subtest: formats null as empty string in full mode
        ok 2 - formats null as empty string in full mode
          ---
          duration_ms: 0.068208
          type: 'test'
          ...
        # Subtest: provides correct ValueInfo for null
        ok 3 - provides correct ValueInfo for null
          ---
          duration_ms: 0.07725
          type: 'test'
          ...
        1..3
    ok 1 - NullFormatter
      ---
      duration_ms: 0.988208
      type: 'suite'
      ...
    # Subtest: UndefinedFormatter
        # Subtest: formats undefined as "undefined" in preview mode
        ok 1 - formats undefined as "undefined" in preview mode
          ---
          duration_ms: 0.084083
          type: 'test'
          ...
        # Subtest: formats undefined as "undefined" in full mode
        ok 2 - formats undefined as "undefined" in full mode
          ---
          duration_ms: 0.056041
          type: 'test'
          ...
        # Subtest: provides correct ValueInfo for undefined
        ok 3 - provides correct ValueInfo for undefined
          ---
          duration_ms: 0.1515
          type: 'test'
          ...
        1..3
    ok 2 - UndefinedFormatter
      ---
      duration_ms: 0.439583
      type: 'suite'
      ...
    # Subtest: StringFormatter
        # Subtest: formats string without quotes in preview mode
        ok 1 - formats string without quotes in preview mode
          ---
          duration_ms: 0.202625
          type: 'test'
          ...
        # Subtest: formats string without quotes in full mode
        ok 2 - formats string without quotes in full mode
          ---
          duration_ms: 0.067916
          type: 'test'
          ...
        # Subtest: truncates long strings in preview mode
        ok 3 - truncates long strings in preview mode
          ---
          duration_ms: 0.245583
          type: 'test'
          ...
        # Subtest: does not truncate in full mode
        ok 4 - does not truncate in full mode
          ---
          duration_ms: 0.201417
          type: 'test'
          ...
        # Subtest: handles empty string
        ok 5 - handles empty string
          ---
          duration_ms: 0.05275
          type: 'test'
          ...
        # Subtest: handles special characters
        ok 6 - handles special characters
          ---
          duration_ms: 0.041125
          type: 'test'
          ...
        # Subtest: handles Unicode
        ok 7 - handles Unicode
          ---
          duration_ms: 0.037
          type: 'test'
          ...
        # Subtest: provides correct ValueInfo for string
        ok 8 - provides correct ValueInfo for string
          ---
          duration_ms: 0.050958
          type: 'test'
          ...
        1..8
    ok 3 - StringFormatter
      ---
      duration_ms: 1.564125
      type: 'suite'
      ...
    # Subtest: NumberFormatter
        # Subtest: formats integer
        ok 1 - formats integer
          ---
          duration_ms: 0.091375
          type: 'test'
          ...
        # Subtest: formats float
        ok 2 - formats float
          ---
          duration_ms: 0.038792
          type: 'test'
          ...
        # Subtest: formats zero
        ok 3 - formats zero
          ---
          duration_ms: 0.035875
          type: 'test'
          ...
        # Subtest: formats negative number
        ok 4 - formats negative number
          ---
          duration_ms: 0.032292
          type: 'test'
          ...
        # Subtest: formats Infinity
        ok 5 - formats Infinity
          ---
          duration_ms: 0.031625
          type: 'test'
          ...
        # Subtest: formats -Infinity
        ok 6 - formats -Infinity
          ---
          duration_ms: 0.033583
          type: 'test'
          ...
        # Subtest: formats NaN
        ok 7 - formats NaN
          ---
          duration_ms: 0.030834
          type: 'test'
          ...
        # Subtest: formats scientific notation
        ok 8 - formats scientific notation
          ---
          duration_ms: 0.03325
          type: 'test'
          ...
        # Subtest: provides correct ValueInfo for number
        ok 9 - provides correct ValueInfo for number
          ---
          duration_ms: 0.044583
          type: 'test'
          ...
        1..9
    ok 4 - NumberFormatter
      ---
      duration_ms: 0.514792
      type: 'suite'
      ...
    # Subtest: BooleanFormatter
        # Subtest: formats true
        ok 1 - formats true
          ---
          duration_ms: 0.063416
          type: 'test'
          ...
        # Subtest: formats false
        ok 2 - formats false
          ---
          duration_ms: 0.03075
          type: 'test'
          ...
        # Subtest: provides correct ValueInfo for boolean
        ok 3 - provides correct ValueInfo for boolean
          ---
          duration_ms: 0.040167
          type: 'test'
          ...
        1..3
    ok 5 - BooleanFormatter
      ---
      duration_ms: 0.176125
      type: 'suite'
      ...
    # Subtest: BigIntFormatter
        # Subtest: formats bigint with "n" suffix
        ok 1 - formats bigint with "n" suffix
          ---
          duration_ms: 0.067584
          type: 'test'
          ...
        # Subtest: formats zero bigint
        ok 2 - formats zero bigint
          ---
          duration_ms: 0.105459
          type: 'test'
          ...
        # Subtest: formats negative bigint
        ok 3 - formats negative bigint
          ---
          duration_ms: 0.034959
          type: 'test'
          ...
        # Subtest: provides correct ValueInfo for bigint
        ok 4 - provides correct ValueInfo for bigint
          ---
          duration_ms: 0.04425
          type: 'test'
          ...
        1..4
    ok 6 - BigIntFormatter
      ---
      duration_ms: 0.298041
      type: 'suite'
      ...
    # Subtest: SymbolFormatter
        # Subtest: formats anonymous symbol
        ok 1 - formats anonymous symbol
          ---
          duration_ms: 0.078625
          type: 'test'
          ...
        # Subtest: formats named symbol
        ok 2 - formats named symbol
          ---
          duration_ms: 0.035541
          type: 'test'
          ...
        # Subtest: formats global symbol
        ok 3 - formats global symbol
          ---
          duration_ms: 0.037125
          type: 'test'
          ...
        # Subtest: provides correct ValueInfo for symbol
        ok 4 - provides correct ValueInfo for symbol
          ---
          duration_ms: 0.041458
          type: 'test'
          ...
        1..4
    ok 7 - SymbolFormatter
      ---
      duration_ms: 0.245
      type: 'suite'
      ...
    # Subtest: DateFormatter
        # Subtest: formats date as ISO string
        ok 1 - formats date as ISO string
          ---
          duration_ms: 1.076292
          type: 'test'
          ...
        # Subtest: formats current date
        ok 2 - formats current date
          ---
          duration_ms: 0.074458
          type: 'test'
          ...
        # Subtest: formats invalid date
        ok 3 - formats invalid date
          ---
          duration_ms: 0.045125
          type: 'test'
          ...
        # Subtest: provides correct ValueInfo for date
        ok 4 - provides correct ValueInfo for date
          ---
          duration_ms: 0.061583
          type: 'test'
          ...
        1..4
    ok 8 - DateFormatter
      ---
      duration_ms: 1.323958
      type: 'suite'
      ...
    # Subtest: FunctionFormatter
        # Subtest: formats named function
        ok 1 - formats named function
          ---
          duration_ms: 0.101
          type: 'test'
          ...
        # Subtest: formats anonymous function
        ok 2 - formats anonymous function
          ---
          duration_ms: 0.039292
          type: 'test'
          ...
        # Subtest: formats arrow function
        ok 3 - formats arrow function
          ---
          duration_ms: 0.039125
          type: 'test'
          ...
        # Subtest: formats class constructor
        ok 4 - formats class constructor
          ---
          duration_ms: 0.041333
          type: 'test'
          ...
        # Subtest: provides correct ValueInfo for function
        ok 5 - provides correct ValueInfo for function
          ---
          duration_ms: 0.048583
          type: 'test'
          ...
        1..5
    ok 9 - FunctionFormatter
      ---
      duration_ms: 0.329125
      type: 'suite'
      ...
    # Subtest: ArrayFormatter
        # Subtest: formats empty array
        ok 1 - formats empty array
          ---
          duration_ms: 0.116875
          type: 'test'
          ...
        # Subtest: formats simple array
        ok 2 - formats simple array
          ---
          duration_ms: 0.040542
          type: 'test'
          ...
        # Subtest: formats array with mixed types
        ok 3 - formats array with mixed types
          ---
          duration_ms: 0.03675
          type: 'test'
          ...
        # Subtest: truncates long array in preview mode
        ok 4 - truncates long array in preview mode
          ---
          duration_ms: 0.059792
          type: 'test'
          ...
        # Subtest: formats nested arrays
        ok 5 - formats nested arrays
          ---
          duration_ms: 0.03775
          type: 'test'
          ...
        # Subtest: handles circular arrays with fallback
        ok 6 - handles circular arrays with fallback
          ---
          duration_ms: 0.063166
          type: 'test'
          ...
        # Subtest: formats array length in full mode
        ok 7 - formats array length in full mode
          ---
          duration_ms: 0.047125
          type: 'test'
          ...
        # Subtest: provides correct ValueInfo for array
        ok 8 - provides correct ValueInfo for array
          ---
          duration_ms: 0.046208
          type: 'test'
          ...
        1..8
    ok 10 - ArrayFormatter
      ---
      duration_ms: 0.540417
      type: 'suite'
      ...
    # Subtest: MapFormatter
        # Subtest: formats empty map
        ok 1 - formats empty map
          ---
          duration_ms: 0.079292
          type: 'test'
          ...
        # Subtest: formats map with size
        ok 2 - formats map with size
          ---
          duration_ms: 0.038666
          type: 'test'
          ...
        # Subtest: full mode shows same as preview
        ok 3 - full mode shows same as preview
          ---
          duration_ms: 0.044041
          type: 'test'
          ...
        # Subtest: provides correct ValueInfo for map
        ok 4 - provides correct ValueInfo for map
          ---
          duration_ms: 0.04375
          type: 'test'
          ...
        1..4
    ok 11 - MapFormatter
      ---
      duration_ms: 0.254583
      type: 'suite'
      ...
    # Subtest: SetFormatter
        # Subtest: formats empty set
        ok 1 - formats empty set
          ---
          duration_ms: 0.069834
          type: 'test'
          ...
        # Subtest: formats set with size
        ok 2 - formats set with size
          ---
          duration_ms: 0.03325
          type: 'test'
          ...
        # Subtest: full mode shows same as preview
        ok 3 - full mode shows same as preview
          ---
          duration_ms: 0.040875
          type: 'test'
          ...
        # Subtest: provides correct ValueInfo for set
        ok 4 - provides correct ValueInfo for set
          ---
          duration_ms: 0.042209
          type: 'test'
          ...
        1..4
    ok 12 - SetFormatter
      ---
      duration_ms: 0.234583
      type: 'suite'
      ...
    # Subtest: ObjectFormatter
        # Subtest: formats empty object
        ok 1 - formats empty object
          ---
          duration_ms: 0.195292
          type: 'test'
          ...
        # Subtest: uses inferLabel for objects with name property
        ok 2 - uses inferLabel for objects with name property
          ---
          duration_ms: 0.130417
          type: 'test'
          ...
        # Subtest: uses inferLabel for objects with description property
        ok 3 - uses inferLabel for objects with description property
          ---
          duration_ms: 0.058292
          type: 'test'
          ...
        # Subtest: falls back to property preview for objects without name/desc
        ok 4 - falls back to property preview for objects without name/desc
          ---
          duration_ms: 0.079666
          type: 'test'
          ...
        # Subtest: truncates long property previews
        ok 5 - truncates long property previews
          ---
          duration_ms: 0.141792
          type: 'test'
          ...
        # Subtest: filters out internal properties (__ prefix)
        ok 6 - filters out internal properties (__ prefix)
          ---
          duration_ms: 0.102375
          type: 'test'
          ...
        # Subtest: provides correct ValueInfo for object
        ok 7 - provides correct ValueInfo for object
          ---
          duration_ms: 0.0735
          type: 'test'
          ...
        1..7
    ok 13 - ObjectFormatter
      ---
      duration_ms: 1.479666
      type: 'suite'
      ...
    # Subtest: inferLabel
        # Subtest: extracts name property
        ok 1 - extracts name property
          ---
          duration_ms: 0.098916
          type: 'test'
          ...
        # Subtest: extracts description property
        ok 2 - extracts description property
          ---
          duration_ms: 0.038875
          type: 'test'
          ...
        # Subtest: extracts both name and description
        ok 3 - extracts both name and description
          ---
          duration_ms: 0.036416
          type: 'test'
          ...
        # Subtest: extracts nested name object
        ok 4 - extracts nested name object
          ---
          duration_ms: 0.037375
          type: 'test'
          ...
        # Subtest: falls back to Object{n} for no matches
        ok 5 - falls back to Object{n} for no matches
          ---
          duration_ms: 0.034083
          type: 'test'
          ...
        # Subtest: handles null
        ok 6 - handles null
          ---
          duration_ms: 0.029792
          type: 'test'
          ...
        # Subtest: handles undefined
        ok 7 - handles undefined
          ---
          duration_ms: 0.03
          type: 'test'
          ...
        # Subtest: handles primitives
        ok 8 - handles primitives
          ---
          duration_ms: 0.032667
          type: 'test'
          ...
        # Subtest: handles Date
        ok 9 - handles Date
          ---
          duration_ms: 0.0515
          type: 'test'
          ...
        # Subtest: handles Array
        ok 10 - handles Array
          ---
          duration_ms: 0.031333
          type: 'test'
          ...
        # Subtest: handles Map
        ok 11 - handles Map
          ---
          duration_ms: 0.033875
          type: 'test'
          ...
        # Subtest: handles Set
        ok 12 - handles Set
          ---
          duration_ms: 0.033125
          type: 'test'
          ...
        # Subtest: ignores internal properties (__ prefix)
        ok 13 - ignores internal properties (__ prefix)
          ---
          duration_ms: 0.03325
          type: 'test'
          ...
        # Subtest: case-insensitive matching (NAME, Name, name)
        ok 14 - case-insensitive matching (NAME, Name, name)
          ---
          duration_ms: 0.037958
          type: 'test'
          ...
        # Subtest: matches desc and description
        ok 15 - matches desc and description
          ---
          duration_ms: 0.033667
          type: 'test'
          ...
        1..15
    ok 14 - inferLabel
      ---
      duration_ms: 0.743708
      type: 'suite'
      ...
    # Subtest: edge cases
        # Subtest: handles very long strings without crashing
        ok 1 - handles very long strings without crashing
          ---
          duration_ms: 0.229541
          type: 'test'
          ...
        # Subtest: handles deeply nested objects
        ok 2 - handles deeply nested objects
          ---
          duration_ms: 0.064
          type: 'test'
          ...
        # Subtest: handles objects with null prototype
        ok 3 - handles objects with null prototype
          ---
          duration_ms: 0.044333
          type: 'test'
          ...
        # Subtest: handles proxies
        ok 4 - handles proxies
          ---
          duration_ms: 0.11675
          type: 'test'
          ...
        1..4
    ok 15 - edge cases
      ---
      duration_ms: 0.504
      type: 'suite'
      ...
    1..15
ok 2 - formatters
  ---
  duration_ms: 10.523333
  type: 'suite'
  ...
# Subtest: Memimg Accessor
    # Subtest: getObjectPath - with memimg infrastructure
        # Subtest: returns path for root object
        ok 1 - returns path for root object
          ---
          duration_ms: 2.078042
          type: 'test'
          ...
        # Subtest: returns path for top-level object
        ok 2 - returns path for top-level object
          ---
          duration_ms: 1.1335
          type: 'test'
          ...
        # Subtest: returns path for nested object
        ok 3 - returns path for nested object
          ---
          duration_ms: 0.276167
          type: 'test'
          ...
        # Subtest: returns path for settings object
        ok 4 - returns path for settings object
          ---
          duration_ms: 0.411584
          type: 'test'
          ...
        # Subtest: uses fast path with targetToPath WeakMap
        ok 5 - uses fast path with targetToPath WeakMap
          ---
          duration_ms: 1.333333
          type: 'test'
          ...
        # Subtest: handles multiple references to same object (canonical path)
        ok 6 - handles multiple references to same object (canonical path)
          ---
          duration_ms: 0.372625
          type: 'test'
          ...
        # Subtest: returns correct path after object is added dynamically
        ok 7 - returns correct path after object is added dynamically
          ---
          duration_ms: 0.458333
          type: 'test'
          ...
        # Subtest: handles proxy vs target resolution correctly
        ok 8 - handles proxy vs target resolution correctly
          ---
          duration_ms: 0.23025
          type: 'test'
          ...
        1..8
    ok 1 - getObjectPath - with memimg infrastructure
      ---
      duration_ms: 8.826583
      type: 'suite'
      ...
    # Subtest: getObjectPath - BFS fallback
        # Subtest: falls back to BFS for plain objects without infrastructure
        ok 1 - falls back to BFS for plain objects without infrastructure
          ---
          duration_ms: 0.678958
          type: 'test'
          ...
        # Subtest: finds object in simple graph via BFS
        ok 2 - finds object in simple graph via BFS
          ---
          duration_ms: 0.231541
          type: 'test'
          ...
        # Subtest: finds nested object via BFS
        ok 3 - finds nested object via BFS
          ---
          duration_ms: 0.151583
          type: 'test'
          ...
        # Subtest: finds shortest path in graph with multiple paths
        ok 4 - finds shortest path in graph with multiple paths
          ---
          duration_ms: 0.373333
          type: 'test'
          ...
        # Subtest: handles circular references during BFS
        ok 5 - handles circular references during BFS
          ---
          duration_ms: 0.121292
          type: 'test'
          ...
        # Subtest: avoids infinite loops with circular graphs
        ok 6 - avoids infinite loops with circular graphs
          ---
          duration_ms: 0.064209
          type: 'test'
          ...
        # Subtest: returns null for object not in graph
        ok 7 - returns null for object not in graph
          ---
          duration_ms: 0.074459
          type: 'test'
          ...
        # Subtest: skips internal properties (__ prefix) during BFS
        ok 8 - skips internal properties (__ prefix) during BFS
          ---
          duration_ms: 0.049
          type: 'test'
          ...
        # Subtest: handles deep nesting (>10 levels)
        ok 9 - handles deep nesting (>10 levels)
          ---
          duration_ms: 0.057667
          type: 'test'
          ...
        # Subtest: handles large graphs efficiently
        ok 10 - handles large graphs efficiently
          ---
          duration_ms: 0.146541
          type: 'test'
          ...
        1..10
    ok 2 - getObjectPath - BFS fallback
      ---
      duration_ms: 2.406417
      type: 'suite'
      ...
    # Subtest: getObjectPath - collections
        # Subtest: finds object in array
        ok 1 - finds object in array
          ---
          duration_ms: 0.10675
          type: 'test'
          ...
        # Subtest: finds object in nested array
        ok 2 - finds object in nested array
          ---
          duration_ms: 0.049959
          type: 'test'
          ...
        # Subtest: finds value in Map
        ok 3 - finds value in Map
          ---
          duration_ms: 0.05625
          type: 'test'
          ...
        # Subtest: finds value in Set
        ok 4 - finds value in Set
          ---
          duration_ms: 0.05125
          type: 'test'
          ...
        # Subtest: handles empty array
        ok 5 - handles empty array
          ---
          duration_ms: 0.044
          type: 'test'
          ...
        # Subtest: handles empty Map
        ok 6 - handles empty Map
          ---
          duration_ms: 0.059167
          type: 'test'
          ...
        # Subtest: handles empty Set
        ok 7 - handles empty Set
          ---
          duration_ms: 0.040542
          type: 'test'
          ...
        # Subtest: finds object in mixed collections
        ok 8 - finds object in mixed collections
          ---
          duration_ms: 0.054416
          type: 'test'
          ...
        # Subtest: handles sparse arrays
        ok 9 - handles sparse arrays
          ---
          duration_ms: 0.041291
          type: 'test'
          ...
        # Subtest: handles array-like objects
        ok 10 - handles array-like objects
          ---
          duration_ms: 0.052959
          type: 'test'
          ...
        1..10
    ok 3 - getObjectPath - collections
      ---
      duration_ms: 0.6625
      type: 'suite'
      ...
    # Subtest: getObjectPath - edge cases
        # Subtest: returns null for null input
        ok 1 - returns null for null input
          ---
          duration_ms: 0.141791
          type: 'test'
          ...
        # Subtest: returns null for undefined input
        ok 2 - returns null for undefined input
          ---
          duration_ms: 0.524292
          type: 'test'
          ...
        # Subtest: returns null for primitive values
        ok 3 - returns null for primitive values
          ---
          duration_ms: 0.065875
          type: 'test'
          ...
        # Subtest: handles Date objects
        ok 4 - handles Date objects
          ---
          duration_ms: 0.050083
          type: 'test'
          ...
        # Subtest: handles Function objects
        ok 5 - handles Function objects
          ---
          duration_ms: 0.080334
          type: 'test'
          ...
        # Subtest: handles RegExp objects
        ok 6 - handles RegExp objects
          ---
          duration_ms: 0.047334
          type: 'test'
          ...
        # Subtest: handles Error objects
        ok 7 - handles Error objects
          ---
          duration_ms: 0.052792
          type: 'test'
          ...
        # Subtest: handles objects with null prototype
        ok 8 - handles objects with null prototype
          ---
          duration_ms: 0.042917
          type: 'test'
          ...
        # Subtest: handles class instances
        ok 9 - handles class instances
          ---
          duration_ms: 0.074709
          type: 'test'
          ...
        # Subtest: handles Symbol-keyed properties gracefully
        ok 10 - handles Symbol-keyed properties gracefully
          ---
          duration_ms: 0.050333
          type: 'test'
          ...
        # Subtest: handles frozen objects
        ok 11 - handles frozen objects
          ---
          duration_ms: 0.073917
          type: 'test'
          ...
        # Subtest: handles sealed objects
        ok 12 - handles sealed objects
          ---
          duration_ms: 0.042292
          type: 'test'
          ...
        # Subtest: handles objects with getters
        ok 13 - handles objects with getters
          ---
          duration_ms: 0.063125
          type: 'test'
          ...
        # Subtest: handles WeakMap objects
        ok 14 - handles WeakMap objects
          ---
          duration_ms: 0.091416
          type: 'test'
          ...
        # Subtest: handles WeakSet objects
        ok 15 - handles WeakSet objects
          ---
          duration_ms: 0.055833
          type: 'test'
          ...
        1..15
    ok 4 - getObjectPath - edge cases
      ---
      duration_ms: 1.78175
      type: 'suite'
      ...
    # Subtest: isTrackedObject
        # Subtest: returns true for tracked objects
        ok 1 - returns true for tracked objects
          ---
          duration_ms: 0.276
          type: 'test'
          ...
        # Subtest: returns false for untracked objects
        ok 2 - returns false for untracked objects
          ---
          duration_ms: 0.144042
          type: 'test'
          ...
        # Subtest: returns false for null
        ok 3 - returns false for null
          ---
          duration_ms: 0.381
          type: 'test'
          ...
        # Subtest: returns false for undefined
        ok 4 - returns false for undefined
          ---
          duration_ms: 0.251209
          type: 'test'
          ...
        # Subtest: returns false for primitives
        ok 5 - returns false for primitives
          ---
          duration_ms: 0.62475
          type: 'test'
          ...
        # Subtest: works with dynamically added objects
        ok 6 - works with dynamically added objects
          ---
          duration_ms: 0.097875
          type: 'test'
          ...
        # Subtest: works with BFS fallback for plain objects
        ok 7 - works with BFS fallback for plain objects
          ---
          duration_ms: 0.078959
          type: 'test'
          ...
        1..7
    ok 5 - isTrackedObject
      ---
      duration_ms: 2.127
      type: 'suite'
      ...
    1..5
ok 3 - Memimg Accessor
  ---
  duration_ms: 16.973333
  type: 'suite'
  ...
# Subtest: Memory Image Manager
ok 4 - Memory Image Manager # SKIP
  ---
  duration_ms: 0.260833
  type: 'suite'
  ...
# Subtest: NavigationManager
    # Subtest: initialization
        # Subtest: initializes with root path
        ok 1 - initializes with root path
          ---
          duration_ms: 1.124
          type: 'test'
          ...
        # Subtest: initializes with empty history (only root)
        ok 2 - initializes with empty history (only root)
          ---
          duration_ms: 0.834167
          type: 'test'
          ...
        # Subtest: initializes with current index 0
        ok 3 - initializes with current index 0
          ---
          duration_ms: 0.37
          type: 'test'
          ...
        # Subtest: initializes with root expanded
        ok 4 - initializes with root expanded
          ---
          duration_ms: 0.689292
          type: 'test'
          ...
        # Subtest: initializes with no other paths expanded
        ok 5 - initializes with no other paths expanded
          ---
          duration_ms: 0.8415
          type: 'test'
          ...
        # Subtest: initializes onNavigate callback as null
        ok 6 - initializes onNavigate callback as null
          ---
          duration_ms: 0.428792
          type: 'test'
          ...
        1..6
    ok 1 - initialization
      ---
      duration_ms: 5.740375
      type: 'suite'
      ...
    # Subtest: navigateTo
        # Subtest: navigates to simple path
        ok 1 - navigates to simple path
          ---
          duration_ms: 0.413708
          type: 'test'
          ...
        # Subtest: navigates to nested path
        ok 2 - navigates to nested path
          ---
          duration_ms: 0.643458
          type: 'test'
          ...
        # Subtest: adds to history when addToHistory is true (default)
        ok 3 - adds to history when addToHistory is true (default)
          ---
          duration_ms: 8.664666
          type: 'test'
          ...
        # Subtest: does not add to history when addToHistory is false
        ok 4 - does not add to history when addToHistory is false
          ---
          duration_ms: 0.881666
          type: 'test'
          ...
        # Subtest: truncates forward history when navigating
        ok 5 - truncates forward history when navigating
          ---
          duration_ms: 0.270041
          type: 'test'
          ...
        # Subtest: expands all ancestor paths
        ok 6 - expands all ancestor paths
          ---
          duration_ms: 6.041833
          type: 'test'
          ...
        # Subtest: creates copy of path array (immutability)
        ok 7 - creates copy of path array (immutability)
          ---
          duration_ms: 0.232708
          type: 'test'
          ...
        # Subtest: triggers onNavigate callback
        ok 8 - triggers onNavigate callback
          ---
          duration_ms: 0.219166
          type: 'test'
          ...
        # Subtest: does not trigger onNavigate if null
        ok 9 - does not trigger onNavigate if null
          ---
          duration_ms: 0.1885
          type: 'test'
          ...
        1..9
    ok 2 - navigateTo
      ---
      duration_ms: 18.411458
      type: 'suite'
      ...
    # Subtest: selectedPath
        # Subtest: returns copy of internal path
        ok 1 - returns copy of internal path
          ---
          duration_ms: 0.285416
          type: 'test'
          ...
        # Subtest: reflects current navigation
        ok 2 - reflects current navigation
          ---
          duration_ms: 0.412625
          type: 'test'
          ...
        1..2
    ok 3 - selectedPath
      ---
      duration_ms: 0.889875
      type: 'suite'
      ...
    # Subtest: history
        # Subtest: returns copy of internal history
        ok 1 - returns copy of internal history
          ---
          duration_ms: 0.2335
          type: 'test'
          ...
        # Subtest: builds history correctly
        ok 2 - builds history correctly
          ---
          duration_ms: 0.1995
          type: 'test'
          ...
        # Subtest: each path in history is a copy
        ok 3 - each path in history is a copy
          ---
          duration_ms: 0.171667
          type: 'test'
          ...
        1..3
    ok 4 - history
      ---
      duration_ms: 0.751667
      type: 'suite'
      ...
    # Subtest: goBack
        # Subtest: moves back one step in history
        ok 1 - moves back one step in history
          ---
          duration_ms: 0.3945
          type: 'test'
          ...
        # Subtest: moves back multiple steps
        ok 2 - moves back multiple steps
          ---
          duration_ms: 0.256584
          type: 'test'
          ...
        # Subtest: moves back to root
        ok 3 - moves back to root
          ---
          duration_ms: 0.22775
          type: 'test'
          ...
        # Subtest: does nothing when already at start
        ok 4 - does nothing when already at start
          ---
          duration_ms: 0.1
          type: 'test'
          ...
        # Subtest: updates current index
        ok 5 - updates current index
          ---
          duration_ms: 0.079375
          type: 'test'
          ...
        # Subtest: expands ancestors of new location
        ok 6 - expands ancestors of new location
          ---
          duration_ms: 0.099416
          type: 'test'
          ...
        # Subtest: triggers onNavigate callback
        ok 7 - triggers onNavigate callback
          ---
          duration_ms: 0.090875
          type: 'test'
          ...
        1..7
    ok 5 - goBack
      ---
      duration_ms: 1.465
      type: 'suite'
      ...
    # Subtest: canGoBack
        # Subtest: returns false at start
        ok 1 - returns false at start
          ---
          duration_ms: 0.078209
          type: 'test'
          ...
        # Subtest: returns true after navigation
        ok 2 - returns true after navigation
          ---
          duration_ms: 0.125625
          type: 'test'
          ...
        # Subtest: returns false after going back to start
        ok 3 - returns false after going back to start
          ---
          duration_ms: 0.36425
          type: 'test'
          ...
        1..3
    ok 6 - canGoBack
      ---
      duration_ms: 0.636
      type: 'suite'
      ...
    # Subtest: goForward
        # Subtest: moves forward one step in history
        ok 1 - moves forward one step in history
          ---
          duration_ms: 0.172792
          type: 'test'
          ...
        # Subtest: moves forward multiple steps
        ok 2 - moves forward multiple steps
          ---
          duration_ms: 0.148042
          type: 'test'
          ...
        # Subtest: does nothing when already at end
        ok 3 - does nothing when already at end
          ---
          duration_ms: 1.11125
          type: 'test'
          ...
        # Subtest: updates current index
        ok 4 - updates current index
          ---
          duration_ms: 0.286666
          type: 'test'
          ...
        # Subtest: expands ancestors of new location
        ok 5 - expands ancestors of new location
          ---
          duration_ms: 0.489125
          type: 'test'
          ...
        # Subtest: triggers onNavigate callback
        ok 6 - triggers onNavigate callback
          ---
          duration_ms: 0.293917
          type: 'test'
          ...
        1..6
    ok 7 - goForward
      ---
      duration_ms: 2.712667
      type: 'suite'
      ...
    # Subtest: canGoForward
        # Subtest: returns false when at end
        ok 1 - returns false when at end
          ---
          duration_ms: 1.6145
          type: 'test'
          ...
        # Subtest: returns true after going back
        ok 2 - returns true after going back
          ---
          duration_ms: 1.403167
          type: 'test'
          ...
        # Subtest: returns false after navigating forward to end
        ok 3 - returns false after navigating forward to end
          ---
          duration_ms: 0.122875
          type: 'test'
          ...
        # Subtest: returns false after new navigation truncates forward history
        ok 4 - returns false after new navigation truncates forward history
          ---
          duration_ms: 0.112083
          type: 'test'
          ...
        1..4
    ok 8 - canGoForward
      ---
      duration_ms: 3.82725
      type: 'suite'
      ...
    # Subtest: toggleExpanded
        # Subtest: expands collapsed path
        ok 1 - expands collapsed path
          ---
          duration_ms: 0.098334
          type: 'test'
          ...
        # Subtest: collapses expanded path
        ok 2 - collapses expanded path
          ---
          duration_ms: 0.401708
          type: 'test'
          ...
        # Subtest: handles multiple paths independently
        ok 3 - handles multiple paths independently
          ---
          duration_ms: 11.308208
          type: 'test'
          ...
        # Subtest: does not affect unrelated paths
        ok 4 - does not affect unrelated paths
          ---
          duration_ms: 0.841917
          type: 'test'
          ...
        1..4
    ok 9 - toggleExpanded
      ---
      duration_ms: 12.768333
      type: 'suite'
      ...
    # Subtest: isExpanded
        # Subtest: returns false for non-expanded paths
        ok 1 - returns false for non-expanded paths
          ---
          duration_ms: 0.091583
          type: 'test'
          ...
        # Subtest: returns true for expanded paths
        ok 2 - returns true for expanded paths
          ---
          duration_ms: 0.051167
          type: 'test'
          ...
        # Subtest: returns true for root (initially expanded)
        ok 3 - returns true for root (initially expanded)
          ---
          duration_ms: 0.042791
          type: 'test'
          ...
        1..3
    ok 10 - isExpanded
      ---
      duration_ms: 0.244375
      type: 'suite'
      ...
    # Subtest: toggleNestedExpanded
        # Subtest: expands collapsed nested object
        ok 1 - expands collapsed nested object
          ---
          duration_ms: 0.077208
          type: 'test'
          ...
        # Subtest: collapses expanded nested object
        ok 2 - collapses expanded nested object
          ---
          duration_ms: 0.044959
          type: 'test'
          ...
        # Subtest: handles multiple paths independently
        ok 3 - handles multiple paths independently
          ---
          duration_ms: 0.043542
          type: 'test'
          ...
        # Subtest: is independent from tree expansion
        ok 4 - is independent from tree expansion
          ---
          duration_ms: 0.041584
          type: 'test'
          ...
        1..4
    ok 11 - toggleNestedExpanded
      ---
      duration_ms: 0.250667
      type: 'suite'
      ...
    # Subtest: isNestedExpanded
        # Subtest: returns false for non-expanded nested objects
        ok 1 - returns false for non-expanded nested objects
          ---
          duration_ms: 0.067583
          type: 'test'
          ...
        # Subtest: returns true for expanded nested objects
        ok 2 - returns true for expanded nested objects
          ---
          duration_ms: 0.039334
          type: 'test'
          ...
        # Subtest: returns false initially
        ok 3 - returns false initially
          ---
          duration_ms: 0.31075
          type: 'test'
          ...
        1..3
    ok 12 - isNestedExpanded
      ---
      duration_ms: 0.500333
      type: 'suite'
      ...
    # Subtest: reset
        # Subtest: resets selected path to root
        ok 1 - resets selected path to root
          ---
          duration_ms: 0.346791
          type: 'test'
          ...
        # Subtest: resets history to only root
        ok 2 - resets history to only root
          ---
          duration_ms: 0.775125
          type: 'test'
          ...
        # Subtest: resets current index to 0
        ok 3 - resets current index to 0
          ---
          duration_ms: 0.089709
          type: 'test'
          ...
        # Subtest: clears all expansion state (except root)
        ok 4 - clears all expansion state (except root)
          ---
          duration_ms: 0.075375
          type: 'test'
          ...
        # Subtest: clears all nested expansion state
        ok 5 - clears all nested expansion state
          ---
          duration_ms: 0.063959
          type: 'test'
          ...
        1..5
    ok 13 - reset
      ---
      duration_ms: 1.480791
      type: 'suite'
      ...
    # Subtest: onNavigate callback
        # Subtest: is triggered by navigateTo
        ok 1 - is triggered by navigateTo
          ---
          duration_ms: 0.081333
          type: 'test'
          ...
        # Subtest: is triggered by goBack
        ok 2 - is triggered by goBack
          ---
          duration_ms: 0.050958
          type: 'test'
          ...
        # Subtest: is triggered by goForward
        ok 3 - is triggered by goForward
          ---
          duration_ms: 0.052459
          type: 'test'
          ...
        # Subtest: is triggered by toggleExpanded
        ok 4 - is triggered by toggleExpanded
          ---
          duration_ms: 0.048041
          type: 'test'
          ...
        # Subtest: can be set to null without errors
        ok 5 - can be set to null without errors
          ---
          duration_ms: 0.042792
          type: 'test'
          ...
        # Subtest: can be changed during navigation
        ok 6 - can be changed during navigation
          ---
          duration_ms: 0.052292
          type: 'test'
          ...
        1..6
    ok 14 - onNavigate callback
      ---
      duration_ms: 0.4285
      type: 'suite'
      ...
    # Subtest: edge cases
        # Subtest: handles empty path array
        ok 1 - handles empty path array
          ---
          duration_ms: 0.06425
          type: 'test'
          ...
        # Subtest: handles very long paths
        ok 2 - handles very long paths
          ---
          duration_ms: 0.241167
          type: 'test'
          ...
        # Subtest: handles special characters in path segments
        ok 3 - handles special characters in path segments
          ---
          duration_ms: 0.201375
          type: 'test'
          ...
        # Subtest: handles rapid navigation
        ok 4 - handles rapid navigation
          ---
          duration_ms: 0.160375
          type: 'test'
          ...
        # Subtest: handles back/forward at boundaries
        ok 5 - handles back/forward at boundaries
          ---
          duration_ms: 0.059458
          type: 'test'
          ...
        1..5
    ok 15 - edge cases
      ---
      duration_ms: 0.82175
      type: 'suite'
      ...
    1..15
ok 5 - NavigationManager
  ---
  duration_ms: 52.970416
  type: 'suite'
  ...
# Subtest: Path Utils
    # Subtest: traversePath
        # Subtest: returns root for root path
        ok 1 - returns root for root path
          ---
          duration_ms: 1.987333
          type: 'test'
          ...
        # Subtest: traverses to simple property
        ok 2 - traverses to simple property
          ---
          duration_ms: 0.421791
          type: 'test'
          ...
        # Subtest: traverses to nested property
        ok 3 - traverses to nested property
          ---
          duration_ms: 0.185875
          type: 'test'
          ...
        # Subtest: returns undefined for non-existent path
        ok 4 - returns undefined for non-existent path
          ---
          duration_ms: 0.172333
          type: 'test'
          ...
        # Subtest: returns undefined for partially invalid path
        ok 5 - returns undefined for partially invalid path
          ---
          duration_ms: 0.152542
          type: 'test'
          ...
        # Subtest: handles empty path segments gracefully
        ok 6 - handles empty path segments gracefully
          ---
          duration_ms: 0.141792
          type: 'test'
          ...
        # Subtest: handles numeric array indices
        ok 7 - handles numeric array indices
          ---
          duration_ms: 0.409708
          type: 'test'
          ...
        # Subtest: handles map paths (map:N)
        ok 8 - handles map paths (map:N)
          ---
          duration_ms: 0.228917
          type: 'test'
          ...
        # Subtest: returns null/undefined values when they exist
        ok 9 - returns null/undefined values when they exist
          ---
          duration_ms: 0.808459
          type: 'test'
          ...
        1..9
    ok 1 - traversePath
      ---
      duration_ms: 6.964416
      type: 'suite'
      ...
    # Subtest: getParentPath
        # Subtest: returns null for root path
        ok 1 - returns null for root path
          ---
          duration_ms: 0.476208
          type: 'test'
          ...
        # Subtest: returns root for one-level path
        ok 2 - returns root for one-level path
          ---
          duration_ms: 0.280958
          type: 'test'
          ...
        # Subtest: returns parent for nested path
        ok 3 - returns parent for nested path
          ---
          duration_ms: 0.092708
          type: 'test'
          ...
        # Subtest: returns null for empty path
        ok 4 - returns null for empty path
          ---
          duration_ms: 0.04425
          type: 'test'
          ...
        # Subtest: does not mutate original path
        ok 5 - does not mutate original path
          ---
          duration_ms: 0.051916
          type: 'test'
          ...
        1..5
    ok 2 - getParentPath
      ---
      duration_ms: 1.260542
      type: 'suite'
      ...
    # Subtest: getPathLeaf
        # Subtest: returns last segment
        ok 1 - returns last segment
          ---
          duration_ms: 0.071125
          type: 'test'
          ...
        # Subtest: returns root for root path
        ok 2 - returns root for root path
          ---
          duration_ms: 0.071625
          type: 'test'
          ...
        # Subtest: returns root for empty path
        ok 3 - returns root for empty path
          ---
          duration_ms: 0.049917
          type: 'test'
          ...
        # Subtest: handles single-segment paths
        ok 4 - handles single-segment paths
          ---
          duration_ms: 0.0375
          type: 'test'
          ...
        # Subtest: handles numeric segments
        ok 5 - handles numeric segments
          ---
          duration_ms: 0.033167
          type: 'test'
          ...
        1..5
    ok 3 - getPathLeaf
      ---
      duration_ms: 0.338583
      type: 'suite'
      ...
    # Subtest: pathToKey
        # Subtest: converts simple path to dot notation
        ok 1 - converts simple path to dot notation
          ---
          duration_ms: 0.064625
          type: 'test'
          ...
        # Subtest: converts nested path to dot notation
        ok 2 - converts nested path to dot notation
          ---
          duration_ms: 0.686416
          type: 'test'
          ...
        # Subtest: handles root path
        ok 3 - handles root path
          ---
          duration_ms: 0.354666
          type: 'test'
          ...
        # Subtest: handles empty path
        ok 4 - handles empty path
          ---
          duration_ms: 0.701459
          type: 'test'
          ...
        # Subtest: handles paths with special characters
        ok 5 - handles paths with special characters
          ---
          duration_ms: 0.157292
          type: 'test'
          ...
        1..5
    ok 4 - pathToKey
      ---
      duration_ms: 2.336583
      type: 'suite'
      ...
    # Subtest: keyToPath
        # Subtest: converts dot notation to path array
        ok 1 - converts dot notation to path array
          ---
          duration_ms: 0.22825
          type: 'test'
          ...
        # Subtest: converts nested dot notation
        ok 2 - converts nested dot notation
          ---
          duration_ms: 0.107208
          type: 'test'
          ...
        # Subtest: handles root key
        ok 3 - handles root key
          ---
          duration_ms: 0.102375
          type: 'test'
          ...
        # Subtest: handles empty string
        ok 4 - handles empty string
          ---
          duration_ms: 0.099375
          type: 'test'
          ...
        # Subtest: is inverse of pathToKey
        ok 5 - is inverse of pathToKey
          ---
          duration_ms: 0.105792
          type: 'test'
          ...
        1..5
    ok 5 - keyToPath
      ---
      duration_ms: 0.836625
      type: 'suite'
      ...
    # Subtest: getAncestorPaths
        # Subtest: returns ancestors for nested path
        ok 1 - returns ancestors for nested path
          ---
          duration_ms: 0.57
          type: 'test'
          ...
        # Subtest: returns single ancestor for root
        ok 2 - returns single ancestor for root
          ---
          duration_ms: 0.186375
          type: 'test'
          ...
        # Subtest: returns two ancestors for one-level path
        ok 3 - returns two ancestors for one-level path
          ---
          duration_ms: 0.108584
          type: 'test'
          ...
        # Subtest: returns empty for empty path
        ok 4 - returns empty for empty path
          ---
          duration_ms: 0.094292
          type: 'test'
          ...
        1..4
    ok 6 - getAncestorPaths
      ---
      duration_ms: 1.185625
      type: 'suite'
      ...
    # Subtest: appendToPath
        # Subtest: appends segment to path
        ok 1 - appends segment to path
          ---
          duration_ms: 3.21425
          type: 'test'
          ...
        # Subtest: does not mutate original path
        ok 2 - does not mutate original path
          ---
          duration_ms: 0.22625
          type: 'test'
          ...
        # Subtest: appends to root path
        ok 3 - appends to root path
          ---
          duration_ms: 0.130541
          type: 'test'
          ...
        # Subtest: appends to empty path
        ok 4 - appends to empty path
          ---
          duration_ms: 0.110416
          type: 'test'
          ...
        # Subtest: handles numeric segments
        ok 5 - handles numeric segments
          ---
          duration_ms: 0.105833
          type: 'test'
          ...
        1..5
    ok 7 - appendToPath
      ---
      duration_ms: 4.04375
      type: 'suite'
      ...
    # Subtest: isValidPath
        # Subtest: returns true for valid path
        ok 1 - returns true for valid path
          ---
          duration_ms: 0.246458
          type: 'test'
          ...
        # Subtest: returns true for deeply valid path
        ok 2 - returns true for deeply valid path
          ---
          duration_ms: 0.100333
          type: 'test'
          ...
        # Subtest: returns false for invalid path
        ok 3 - returns false for invalid path
          ---
          duration_ms: 0.096583
          type: 'test'
          ...
        # Subtest: returns false for partially invalid path
        ok 4 - returns false for partially invalid path
          ---
          duration_ms: 0.104625
          type: 'test'
          ...
        # Subtest: returns true for root path
        ok 5 - returns true for root path
          ---
          duration_ms: 0.119583
          type: 'test'
          ...
        # Subtest: handles paths to null values
        ok 6 - handles paths to null values
          ---
          duration_ms: 0.121584
          type: 'test'
          ...
        # Subtest: handles array indices
        ok 7 - handles array indices
          ---
          duration_ms: 0.101958
          type: 'test'
          ...
        1..7
    ok 8 - isValidPath
      ---
      duration_ms: 1.120166
      type: 'suite'
      ...
    # Subtest: isRootPath
        # Subtest: returns true for root path
        ok 1 - returns true for root path
          ---
          duration_ms: 0.188542
          type: 'test'
          ...
        # Subtest: returns false for non-root path
        ok 2 - returns false for non-root path
          ---
          duration_ms: 0.099292
          type: 'test'
          ...
        # Subtest: returns false for empty path
        ok 3 - returns false for empty path
          ---
          duration_ms: 0.08975
          type: 'test'
          ...
        # Subtest: returns false for path starting with non-root
        ok 4 - returns false for path starting with non-root
          ---
          duration_ms: 0.092375
          type: 'test'
          ...
        # Subtest: returns false for nested path
        ok 5 - returns false for nested path
          ---
          duration_ms: 0.097166
          type: 'test'
          ...
        1..5
    ok 9 - isRootPath
      ---
      duration_ms: 0.757416
      type: 'suite'
      ...
    # Subtest: normalizePath
        # Subtest: adds root to path without root
        ok 1 - adds root to path without root
          ---
          duration_ms: 0.234083
          type: 'test'
          ...
        # Subtest: does not modify path already starting with root
        ok 2 - does not modify path already starting with root
          ---
          duration_ms: 0.103708
          type: 'test'
          ...
        # Subtest: adds root to empty path
        ok 3 - adds root to empty path
          ---
          duration_ms: 0.097042
          type: 'test'
          ...
        # Subtest: handles single non-root segment
        ok 4 - handles single non-root segment
          ---
          duration_ms: 0.103583
          type: 'test'
          ...
        # Subtest: does not mutate original path
        ok 5 - does not mutate original path
          ---
          duration_ms: 0.104833
          type: 'test'
          ...
        1..5
    ok 10 - normalizePath
      ---
      duration_ms: 0.857458
      type: 'suite'
      ...
    # Subtest: edge cases
        # Subtest: handles very deep paths
        ok 1 - handles very deep paths
          ---
          duration_ms: 0.270875
          type: 'test'
          ...
        # Subtest: handles paths with special characters
        ok 2 - handles paths with special characters
          ---
          duration_ms: 0.106958
          type: 'test'
          ...
        # Subtest: handles paths with empty segments
        ok 3 - handles paths with empty segments
          ---
          duration_ms: 0.123709
          type: 'test'
          ...
        # Subtest: handles circular reference traversal (stops at undefined)
        ok 4 - handles circular reference traversal (stops at undefined)
          ---
          duration_ms: 0.126209
          type: 'test'
          ...
        # Subtest: handles traversal through Map keys
        ok 5 - handles traversal through Map keys
          ---
          duration_ms: 0.129625
          type: 'test'
          ...
        # Subtest: handles very long paths without performance issues
        ok 6 - handles very long paths without performance issues
          ---
          duration_ms: 2.213125
          type: 'test'
          ...
        1..6
    ok 11 - edge cases
      ---
      duration_ms: 3.185333
      type: 'suite'
      ...
    1..11
ok 6 - Path Utils
  ---
  duration_ms: 29.197333
  type: 'suite'
  ...
# Subtest: Property Access
    # Subtest: getOwnProperties
        # Subtest: returns empty array for null
        ok 1 - returns empty array for null
          ---
          duration_ms: 1.699833
          type: 'test'
          ...
        # Subtest: returns empty array for undefined
        ok 2 - returns empty array for undefined
          ---
          duration_ms: 0.109208
          type: 'test'
          ...
        # Subtest: returns properties for simple object
        ok 3 - returns properties for simple object
          ---
          duration_ms: 0.224708
          type: 'test'
          ...
        # Subtest: returns properties with internal properties
        ok 4 - returns properties with internal properties
          ---
          duration_ms: 0.073625
          type: 'test'
          ...
        # Subtest: returns empty array for empty object
        ok 5 - returns empty array for empty object
          ---
          duration_ms: 0.055833
          type: 'test'
          ...
        # Subtest: works with Object.create(null)
        ok 6 - works with Object.create(null)
          ---
          duration_ms: 0.053417
          type: 'test'
          ...
        # Subtest: handles objects with symbol keys (filters them out)
        ok 7 - handles objects with symbol keys (filters them out)
          ---
          duration_ms: 0.157792
          type: 'test'
          ...
        # Subtest: handles objects with getters
        ok 8 - handles objects with getters
          ---
          duration_ms: 0.079042
          type: 'test'
          ...
        # Subtest: handles objects with null/undefined values
        ok 9 - handles objects with null/undefined values
          ---
          duration_ms: 0.265459
          type: 'test'
          ...
        # Subtest: uses Reflect.ownKeys fallback for proxies
        ok 10 - uses Reflect.ownKeys fallback for proxies
          ---
          duration_ms: 0.320083
          type: 'test'
          ...
        # Subtest: handles frozen objects
        ok 11 - handles frozen objects
          ---
          duration_ms: 0.07525
          type: 'test'
          ...
        # Subtest: handles sealed objects
        ok 12 - handles sealed objects
          ---
          duration_ms: 0.045792
          type: 'test'
          ...
        1..12
    ok 1 - getOwnProperties
      ---
      duration_ms: 4.313292
      type: 'suite'
      ...
    # Subtest: getVisibleProperties
        # Subtest: filters out internal properties
        ok 1 - filters out internal properties
          ---
          duration_ms: 0.141792
          type: 'test'
          ...
        # Subtest: returns all properties when none are internal
        ok 2 - returns all properties when none are internal
          ---
          duration_ms: 0.041
          type: 'test'
          ...
        # Subtest: returns empty for object with only internal properties
        ok 3 - returns empty for object with only internal properties
          ---
          duration_ms: 0.090458
          type: 'test'
          ...
        # Subtest: handles mixed test object
        ok 4 - handles mixed test object
          ---
          duration_ms: 0.057792
          type: 'test'
          ...
        # Subtest: returns empty for null
        ok 5 - returns empty for null
          ---
          duration_ms: 0.034833
          type: 'test'
          ...
        # Subtest: returns empty for undefined
        ok 6 - returns empty for undefined
          ---
          duration_ms: 0.030792
          type: 'test'
          ...
        1..6
    ok 2 - getVisibleProperties
      ---
      duration_ms: 0.472
      type: 'suite'
      ...
    # Subtest: partitionProperties
        # Subtest: separates scalars from collections
        ok 1 - separates scalars from collections
          ---
          duration_ms: 0.237208
          type: 'test'
          ...
        # Subtest: returns only scalars when no collections
        ok 2 - returns only scalars when no collections
          ---
          duration_ms: 0.054542
          type: 'test'
          ...
        # Subtest: returns only collections when no scalars
        ok 3 - returns only collections when no scalars
          ---
          duration_ms: 0.75475
          type: 'test'
          ...
        # Subtest: returns empty arrays for empty object
        ok 4 - returns empty arrays for empty object
          ---
          duration_ms: 0.068083
          type: 'test'
          ...
        # Subtest: filters internal properties before partitioning
        ok 5 - filters internal properties before partitioning
          ---
          duration_ms: 0.175292
          type: 'test'
          ...
        # Subtest: classifies Date as scalar (not collection)
        ok 6 - classifies Date as scalar (not collection)
          ---
          duration_ms: 0.071875
          type: 'test'
          ...
        # Subtest: classifies nested objects as scalars
        ok 7 - classifies nested objects as scalars
          ---
          duration_ms: 0.063125
          type: 'test'
          ...
        1..7
    ok 3 - partitionProperties
      ---
      duration_ms: 1.520666
      type: 'suite'
      ...
    # Subtest: countVisibleProperties
        # Subtest: counts visible properties
        ok 1 - counts visible properties
          ---
          duration_ms: 0.074
          type: 'test'
          ...
        # Subtest: excludes internal properties from count
        ok 2 - excludes internal properties from count
          ---
          duration_ms: 0.035333
          type: 'test'
          ...
        # Subtest: returns 0 for empty object
        ok 3 - returns 0 for empty object
          ---
          duration_ms: 0.033708
          type: 'test'
          ...
        # Subtest: returns 0 for null
        ok 4 - returns 0 for null
          ---
          duration_ms: 0.029791
          type: 'test'
          ...
        # Subtest: returns 0 for undefined
        ok 5 - returns 0 for undefined
          ---
          duration_ms: 0.030542
          type: 'test'
          ...
        # Subtest: returns 0 for object with only internal properties
        ok 6 - returns 0 for object with only internal properties
          ---
          duration_ms: 0.034583
          type: 'test'
          ...
        # Subtest: counts properties in large object
        ok 7 - counts properties in large object
          ---
          duration_ms: 0.586458
          type: 'test'
          ...
        1..7
    ok 4 - countVisibleProperties
      ---
      duration_ms: 0.964709
      type: 'suite'
      ...
    # Subtest: hasVisibleProperties
        # Subtest: returns true for object with visible properties
        ok 1 - returns true for object with visible properties
          ---
          duration_ms: 0.119666
          type: 'test'
          ...
        # Subtest: returns false for empty object
        ok 2 - returns false for empty object
          ---
          duration_ms: 0.030417
          type: 'test'
          ...
        # Subtest: returns false for null
        ok 3 - returns false for null
          ---
          duration_ms: 0.029917
          type: 'test'
          ...
        # Subtest: returns false for undefined
        ok 4 - returns false for undefined
          ---
          duration_ms: 0.030208
          type: 'test'
          ...
        # Subtest: returns false for object with only internal properties
        ok 5 - returns false for object with only internal properties
          ---
          duration_ms: 0.034041
          type: 'test'
          ...
        # Subtest: returns true for object with mix of internal and visible
        ok 6 - returns true for object with mix of internal and visible
          ---
          duration_ms: 0.034458
          type: 'test'
          ...
        # Subtest: uses fast path for regular objects
        ok 7 - uses fast path for regular objects
          ---
          duration_ms: 0.032333
          type: 'test'
          ...
        # Subtest: uses Reflect.ownKeys fallback for proxies
        ok 8 - uses Reflect.ownKeys fallback for proxies
          ---
          duration_ms: 0.03675
          type: 'test'
          ...
        1..8
    ok 5 - hasVisibleProperties
      ---
      duration_ms: 0.437125
      type: 'suite'
      ...
    # Subtest: edge cases
        # Subtest: handles objects with numeric keys
        ok 1 - handles objects with numeric keys
          ---
          duration_ms: 0.088083
          type: 'test'
          ...
        # Subtest: handles objects with special character keys
        ok 2 - handles objects with special character keys
          ---
          duration_ms: 0.041375
          type: 'test'
          ...
        # Subtest: handles very large objects
        ok 3 - handles very large objects
          ---
          duration_ms: 8.802333
          type: 'test'
          ...
        # Subtest: handles objects with circular references
        ok 4 - handles objects with circular references
          ---
          duration_ms: 0.100459
          type: 'test'
          ...
        # Subtest: handles class instances
        ok 5 - handles class instances
          ---
          duration_ms: 0.071708
          type: 'test'
          ...
        # Subtest: handles Error objects
        ok 6 - handles Error objects
          ---
          duration_ms: 0.150458
          type: 'test'
          ...
        # Subtest: handles Arrays (which are objects)
        ok 7 - handles Arrays (which are objects)
          ---
          duration_ms: 0.05425
          type: 'test'
          ...
        1..7
    ok 6 - edge cases
      ---
      duration_ms: 9.422334
      type: 'suite'
      ...
    # Subtest: getOwnProperties - ObjectType proxy fallback
        # Subtest: should use Reflect.ownKeys as fast path for normal objects
        ok 1 - should use Reflect.ownKeys as fast path for normal objects
          ---
          duration_ms: 0.087458
          type: 'test'
          ...
        # Subtest: should handle empty objects correctly
        ok 2 - should handle empty objects correctly
          ---
          duration_ms: 0.03675
          type: 'test'
          ...
        # Subtest: should handle Arrays with all properties including length
        ok 3 - should handle Arrays with all properties including length
          ---
          duration_ms: 0.053166
          type: 'test'
          ...
        # Subtest: should work with standard proxies
        ok 4 - should work with standard proxies
          ---
          duration_ms: 0.055709
          type: 'test'
          ...
        # Subtest: should fall back gracefully when Reflect.ownKeys has no string keys
        ok 5 - should fall back gracefully when Reflect.ownKeys has no string keys
          ---
          duration_ms: 0.05575
          type: 'test'
          ...
        1..5
    ok 7 - getOwnProperties - ObjectType proxy fallback
      ---
      duration_ms: 0.357292
      type: 'suite'
      ...
    1..7
ok 7 - Property Access
  ---
  duration_ms: 18.317875
  type: 'suite'
  ...
# Subtest: Value Types
    # Subtest: classifyValue - primitives
        # Subtest: classifies null
        ok 1 - classifies null
          ---
          duration_ms: 0.476625
          type: 'test'
          ...
        # Subtest: classifies undefined
        ok 2 - classifies undefined
          ---
          duration_ms: 0.092584
          type: 'test'
          ...
        # Subtest: classifies string
        ok 3 - classifies string
          ---
          duration_ms: 0.065292
          type: 'test'
          ...
        # Subtest: classifies empty string
        ok 4 - classifies empty string
          ---
          duration_ms: 0.068708
          type: 'test'
          ...
        # Subtest: classifies number
        ok 5 - classifies number
          ---
          duration_ms: 0.056375
          type: 'test'
          ...
        # Subtest: classifies zero
        ok 6 - classifies zero
          ---
          duration_ms: 0.053833
          type: 'test'
          ...
        # Subtest: classifies negative number
        ok 7 - classifies negative number
          ---
          duration_ms: 0.14475
          type: 'test'
          ...
        # Subtest: classifies float
        ok 8 - classifies float
          ---
          duration_ms: 0.0565
          type: 'test'
          ...
        # Subtest: classifies Infinity
        ok 9 - classifies Infinity
          ---
          duration_ms: 0.25175
          type: 'test'
          ...
        # Subtest: classifies NaN
        ok 10 - classifies NaN
          ---
          duration_ms: 0.283875
          type: 'test'
          ...
        # Subtest: classifies boolean true
        ok 11 - classifies boolean true
          ---
          duration_ms: 0.0685
          type: 'test'
          ...
        # Subtest: classifies boolean false
        ok 12 - classifies boolean false
          ---
          duration_ms: 0.05125
          type: 'test'
          ...
        # Subtest: classifies bigint
        ok 13 - classifies bigint
          ---
          duration_ms: 0.039417
          type: 'test'
          ...
        # Subtest: classifies symbol
        ok 14 - classifies symbol
          ---
          duration_ms: 0.036167
          type: 'test'
          ...
        1..14
    ok 1 - classifyValue - primitives
      ---
      duration_ms: 2.602125
      type: 'suite'
      ...
    # Subtest: classifyValue - special types
        # Subtest: classifies Date
        ok 1 - classifies Date
          ---
          duration_ms: 0.110291
          type: 'test'
          ...
        # Subtest: classifies invalid Date
        ok 2 - classifies invalid Date
          ---
          duration_ms: 1.239125
          type: 'test'
          ...
        # Subtest: classifies named function
        ok 3 - classifies named function
          ---
          duration_ms: 0.080958
          type: 'test'
          ...
        # Subtest: classifies anonymous function
        ok 4 - classifies anonymous function
          ---
          duration_ms: 0.042542
          type: 'test'
          ...
        # Subtest: classifies arrow function
        ok 5 - classifies arrow function
          ---
          duration_ms: 0.036916
          type: 'test'
          ...
        # Subtest: classifies class constructor
        ok 6 - classifies class constructor
          ---
          duration_ms: 0.160458
          type: 'test'
          ...
        # Subtest: classifies async function
        ok 7 - classifies async function
          ---
          duration_ms: 0.039416
          type: 'test'
          ...
        # Subtest: classifies generator function
        ok 8 - classifies generator function
          ---
          duration_ms: 0.036208
          type: 'test'
          ...
        1..8
    ok 2 - classifyValue - special types
      ---
      duration_ms: 1.852292
      type: 'suite'
      ...
    # Subtest: classifyValue - collections
        # Subtest: classifies empty array
        ok 1 - classifies empty array
          ---
          duration_ms: 0.096334
          type: 'test'
          ...
        # Subtest: classifies simple array
        ok 2 - classifies simple array
          ---
          duration_ms: 0.036167
          type: 'test'
          ...
        # Subtest: classifies nested array
        ok 3 - classifies nested array
          ---
          duration_ms: 0.032792
          type: 'test'
          ...
        # Subtest: classifies typed array as array
        ok 4 - classifies typed array as array
          ---
          duration_ms: 0.079917
          type: 'test'
          ...
        # Subtest: classifies empty Map
        ok 5 - classifies empty Map
          ---
          duration_ms: 0.040625
          type: 'test'
          ...
        # Subtest: classifies Map with entries
        ok 6 - classifies Map with entries
          ---
          duration_ms: 0.040875
          type: 'test'
          ...
        # Subtest: classifies empty Set
        ok 7 - classifies empty Set
          ---
          duration_ms: 0.038208
          type: 'test'
          ...
        # Subtest: classifies Set with values
        ok 8 - classifies Set with values
          ---
          duration_ms: 0.083875
          type: 'test'
          ...
        # Subtest: classifies WeakMap as object (not Map)
        ok 9 - classifies WeakMap as object (not Map)
          ---
          duration_ms: 0.039917
          type: 'test'
          ...
        # Subtest: classifies WeakSet as object (not Set)
        ok 10 - classifies WeakSet as object (not Set)
          ---
          duration_ms: 0.038167
          type: 'test'
          ...
        1..10
    ok 3 - classifyValue - collections
      ---
      duration_ms: 0.622333
      type: 'suite'
      ...
    # Subtest: classifyValue - objects
        # Subtest: classifies empty object
        ok 1 - classifies empty object
          ---
          duration_ms: 0.094583
          type: 'test'
          ...
        # Subtest: classifies simple object
        ok 2 - classifies simple object
          ---
          duration_ms: 0.033292
          type: 'test'
          ...
        # Subtest: classifies nested object
        ok 3 - classifies nested object
          ---
          duration_ms: 0.033375
          type: 'test'
          ...
        # Subtest: classifies object with null prototype
        ok 4 - classifies object with null prototype
          ---
          duration_ms: 0.032042
          type: 'test'
          ...
        # Subtest: classifies class instance as object
        ok 5 - classifies class instance as object
          ---
          duration_ms: 0.046833
          type: 'test'
          ...
        # Subtest: classifies RegExp as object
        ok 6 - classifies RegExp as object
          ---
          duration_ms: 0.03625
          type: 'test'
          ...
        # Subtest: classifies Error as object
        ok 7 - classifies Error as object
          ---
          duration_ms: 0.04225
          type: 'test'
          ...
        # Subtest: classifies Promise as object
        ok 8 - classifies Promise as object
          ---
          duration_ms: 0.033708
          type: 'test'
          ...
        # Subtest: classifies proxy as object
        ok 9 - classifies proxy as object
          ---
          duration_ms: 0.065916
          type: 'test'
          ...
        1..9
    ok 4 - classifyValue - objects
      ---
      duration_ms: 0.513458
      type: 'suite'
      ...
    # Subtest: isLeafLikeObject
        # Subtest: returns true for small objects (â‰¤ 5 properties)
        ok 1 - returns true for small objects (â‰¤ 5 properties)
          ---
          duration_ms: 0.251
          type: 'test'
          ...
        # Subtest: returns false for large objects (> 5 properties)
        ok 2 - returns false for large objects (> 5 properties)
          ---
          duration_ms: 0.040333
          type: 'test'
          ...
        # Subtest: excludes internal properties (__) from count
        ok 3 - excludes internal properties (__) from count
          ---
          duration_ms: 0.041542
          type: 'test'
          ...
        # Subtest: returns false for null
        ok 4 - returns false for null
          ---
          duration_ms: 0.031333
          type: 'test'
          ...
        # Subtest: returns false for undefined
        ok 5 - returns false for undefined
          ---
          duration_ms: 0.031
          type: 'test'
          ...
        # Subtest: returns false for primitives
        ok 6 - returns false for primitives
          ---
          duration_ms: 0.033542
          type: 'test'
          ...
        # Subtest: returns false for Date
        ok 7 - returns false for Date
          ---
          duration_ms: 0.031708
          type: 'test'
          ...
        # Subtest: returns false for Array
        ok 8 - returns false for Array
          ---
          duration_ms: 0.033625
          type: 'test'
          ...
        # Subtest: returns false for Map
        ok 9 - returns false for Map
          ---
          duration_ms: 0.030417
          type: 'test'
          ...
        # Subtest: returns false for Set
        ok 10 - returns false for Set
          ---
          duration_ms: 0.032
          type: 'test'
          ...
        # Subtest: returns false for Function
        ok 11 - returns false for Function
          ---
          duration_ms: 0.032792
          type: 'test'
          ...
        # Subtest: returns false for objects with nested objects
        ok 12 - returns false for objects with nested objects
          ---
          duration_ms: 0.039125
          type: 'test'
          ...
        # Subtest: returns false for objects with arrays
        ok 13 - returns false for objects with arrays
          ---
          duration_ms: 0.038833
          type: 'test'
          ...
        # Subtest: returns true for objects with only scalar properties
        ok 14 - returns true for objects with only scalar properties
          ---
          duration_ms: 0.037209
          type: 'test'
          ...
        # Subtest: returns true for objects with null/undefined values
        ok 15 - returns true for objects with null/undefined values
          ---
          duration_ms: 0.038625
          type: 'test'
          ...
        # Subtest: returns true for empty object
        ok 16 - returns true for empty object
          ---
          duration_ms: 0.033458
          type: 'test'
          ...
        1..16
    ok 5 - isLeafLikeObject
      ---
      duration_ms: 0.938917
      type: 'suite'
      ...
    # Subtest: edge cases
        # Subtest: handles all test values from FORMAT_TEST_VALUES
        ok 1 - handles all test values from FORMAT_TEST_VALUES
          ---
          duration_ms: 0.192875
          type: 'test'
          ...
        # Subtest: handles circular references
        ok 2 - handles circular references
          ---
          duration_ms: 0.040042
          type: 'test'
          ...
        # Subtest: handles very deeply nested objects
        ok 3 - handles very deeply nested objects
          ---
          duration_ms: 0.050958
          type: 'test'
          ...
        # Subtest: handles objects with symbol keys
        ok 4 - handles objects with symbol keys
          ---
          duration_ms: 0.039625
          type: 'test'
          ...
        # Subtest: handles frozen objects
        ok 5 - handles frozen objects
          ---
          duration_ms: 0.035959
          type: 'test'
          ...
        # Subtest: handles sealed objects
        ok 6 - handles sealed objects
          ---
          duration_ms: 0.037083
          type: 'test'
          ...
        # Subtest: handles objects with getters
        ok 7 - handles objects with getters
          ---
          duration_ms: 0.298042
          type: 'test'
          ...
        # Subtest: handles Buffer as object (Node.js)
        ok 8 - handles Buffer as object (Node.js)
          ---
          duration_ms: 0.603167
          type: 'test'
          ...
        1..8
    ok 6 - edge cases
      ---
      duration_ms: 1.462
      type: 'suite'
      ...
    # Subtest: navigability
        # Subtest: marks primitives as non-navigable
        ok 1 - marks primitives as non-navigable
          ---
          duration_ms: 0.263958
          type: 'test'
          ...
        # Subtest: marks Date as navigable
        ok 2 - marks Date as navigable
          ---
          duration_ms: 0.111583
          type: 'test'
          ...
        # Subtest: marks objects as navigable
        ok 3 - marks objects as navigable
          ---
          duration_ms: 0.110125
          type: 'test'
          ...
        # Subtest: marks arrays as navigable
        ok 4 - marks arrays as navigable
          ---
          duration_ms: 0.105375
          type: 'test'
          ...
        # Subtest: marks collections as navigable
        ok 5 - marks collections as navigable
          ---
          duration_ms: 0.105334
          type: 'test'
          ...
        # Subtest: marks functions as navigable
        ok 6 - marks functions as navigable
          ---
          duration_ms: 1.119708
          type: 'test'
          ...
        1..6
    ok 7 - navigability
      ---
      duration_ms: 2.021542
      type: 'suite'
      ...
    # Subtest: isDateLike
        # Subtest: returns true for direct Date instances
        ok 1 - returns true for direct Date instances
          ---
          duration_ms: 0.734875
          type: 'test'
          ...
        # Subtest: returns true for proxied Dates
        ok 2 - returns true for proxied Dates
          ---
          duration_ms: 0.081416
          type: 'test'
          ...
        # Subtest: returns false for null and undefined
        ok 3 - returns false for null and undefined
          ---
          duration_ms: 0.042834
          type: 'test'
          ...
        # Subtest: returns false for primitives
        ok 4 - returns false for primitives
          ---
          duration_ms: 0.040416
          type: 'test'
          ...
        # Subtest: returns false for non-Date objects
        ok 5 - returns false for non-Date objects
          ---
          duration_ms: 0.044709
          type: 'test'
          ...
        # Subtest: returns false for objects with only getTime
        ok 6 - returns false for objects with only getTime
          ---
          duration_ms: 0.039584
          type: 'test'
          ...
        # Subtest: returns false for objects with only toISOString
        ok 7 - returns false for objects with only toISOString
          ---
          duration_ms: 0.034042
          type: 'test'
          ...
        # Subtest: returns true for Date-like objects with both methods
        ok 8 - returns true for Date-like objects with both methods
          ---
          duration_ms: 0.039417
          type: 'test'
          ...
        1..8
    ok 8 - isDateLike
      ---
      duration_ms: 1.157667
      type: 'suite'
      ...
    1..8
ok 8 - Value Types
  ---
  duration_ms: 11.683458
  type: 'suite'
  ...
1..8
# tests 440
# suites 81
# pass 440
# fail 0
# cancelled 0
# skipped 0
# todo 0
# duration_ms 270.720834

> filer@0.1.0 test:metadata
> tsx test/metadata/run-tests.ts

ðŸ§ª Metadata Test Suite

ðŸ“ Found 1 test file(s):

   - test/metadata/unit/core.test.ts

â–¶ Metadata Type System Core
  â–¶ placeholder tests
    âœ” type system core tests will go here (0.290292ms)
  âœ” placeholder tests (0.626375ms)
âœ” Metadata Type System Core (0.803334ms)

============================================================
ðŸ“Š Test Summary
============================================================
âœ… Passed:  3
âŒ Failed:  0
â­ï¸  Skipped: 0
ðŸ“ˆ Total:   3
============================================================

âœ… All tests passed!


> filer@0.1.0 test:integration
> tsx test/integration/run-tests.ts

ðŸ§ª Integration Test Suite (Cross-Component)

ðŸ“ Found 1 test file(s):

   - test/integration/placeholder.test.ts

â–¶ Cross-Component Integration Tests
  â–¶ placeholder tests
    âœ” integration tests will go here (0.347084ms)
  âœ” placeholder tests (0.681375ms)
âœ” Cross-Component Integration Tests (0.886625ms)

============================================================
ðŸ“Š Test Summary
============================================================
âœ… Passed:  3
âŒ Failed:  0
â­ï¸  Skipped: 0
ðŸ“ˆ Total:   3
============================================================

âœ… All tests passed!


> filer@0.1.0 test:browser
> playwright test

[2m[WebServer] [22m(node:15062) [DEP0066] DeprecationWarning: OutgoingMessage.prototype._headers is deprecated
[2m[WebServer] [22m(Use `node --trace-deprecation ...` to show where the warning was created)

Running 16 tests using 4 workers

  âœ“   3 [chromium] â€º test/memimg/browser/event-log-browser.spec.ts:67:3 â€º IndexedDB Event Log â€º appends multiple events to IndexedDB (337ms)
  âœ“   4 [chromium] â€º test/memimg/browser/event-log-browser.spec.ts:30:3 â€º IndexedDB Event Log â€º creates IndexedDB event log (332ms)
  âœ“   2 [chromium] â€º test/memimg/browser/event-log-browser.spec.ts:99:3 â€º IndexedDB Event Log â€º retrieves all events from IndexedDB in order (341ms)
  -   5 [chromium] â€º test/memimg/browser/event-log-browser.spec.ts:202:8 â€º IndexedDB Event Log â€º handles multiple stores in same database
  âœ“   1 [chromium] â€º test/memimg/browser/event-log-browser.spec.ts:40:3 â€º IndexedDB Event Log â€º appends event to IndexedDB (346ms)
  âœ“   6 [chromium] â€º test/memimg/browser/event-log-browser.spec.ts:132:3 â€º IndexedDB Event Log â€º clears all events from IndexedDB (116ms)
  âœ“   9 [chromium] â€º test/memimg/browser/event-log-browser.spec.ts:263:3 â€º LocalStorage Event Log â€º creates LocalStorage event log (110ms)
  âœ“   8 [chromium] â€º test/memimg/browser/event-log-browser.spec.ts:236:3 â€º IndexedDB Event Log â€º handles close() called multiple times (idempotent) (165ms)
  âœ“   7 [chromium] â€º test/memimg/browser/event-log-browser.spec.ts:165:3 â€º IndexedDB Event Log â€º closes IndexedDB connection (195ms)
  âœ“  11 [chromium] â€º test/memimg/browser/event-log-browser.spec.ts:300:3 â€º LocalStorage Event Log â€º appends multiple events to LocalStorage (85ms)
  âœ“  10 [chromium] â€º test/memimg/browser/event-log-browser.spec.ts:273:3 â€º LocalStorage Event Log â€º appends event to LocalStorage (95ms)
  âœ“  12 [chromium] â€º test/memimg/browser/event-log-browser.spec.ts:332:3 â€º LocalStorage Event Log â€º retrieves all events from LocalStorage (144ms)
  âœ“  13 [chromium] â€º test/memimg/browser/event-log-browser.spec.ts:361:3 â€º LocalStorage Event Log â€º clears all events from LocalStorage (117ms)
  âœ“  14 [chromium] â€º test/memimg/browser/event-log-browser.spec.ts:394:3 â€º LocalStorage Event Log â€º persists events across log instances (101ms)
  âœ“  15 [chromium] â€º test/memimg/browser/event-log-browser.spec.ts:416:3 â€º LocalStorage Event Log â€º handles empty LocalStorage (101ms)
  âœ“  16 [chromium] â€º test/memimg/browser/event-log-browser.spec.ts:427:3 â€º LocalStorage Event Log â€º uses different keys for isolation (76ms)

  1 skipped
  15 passed (2.2s)
